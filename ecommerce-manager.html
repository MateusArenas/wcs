<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-commerce Manager - Central de Vendas Multi-Plataforma</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--gray-50);
            color: var(--gray-900);
        }

        /* Header */
        .header {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .notification-badge {
            position: relative;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: background 0.2s;
        }

        .notification-badge:hover {
            background: var(--gray-100);
        }

        .badge-count {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* Layout */
        .container {
            display: flex;
            min-height: calc(100vh - 73px);
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: white;
            border-right: 1px solid var(--gray-200);
            padding: 1.5rem 0;
        }

        .nav-item {
            padding: 0.875rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--gray-700);
            font-weight: 500;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--gray-50);
            color: var(--primary);
        }

        .nav-item.active {
            background: #eff6ff;
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Dashboard Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--gray-200);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-title {
            color: var(--gray-600);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }

        .stat-change {
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        /* Tables */
        .card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--gray-200);
            margin-bottom: 1.5rem;
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .card-body {
            padding: 1.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: var(--gray-50);
        }

        th {
            padding: 0.875rem 1rem;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        td {
            padding: 1rem;
            border-top: 1px solid var(--gray-200);
        }

        tbody tr:hover {
            background: var(--gray-50);
        }

        /* Buttons */
        .btn {
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-outline {
            background: white;
            border: 1px solid var(--gray-300);
            color: var(--gray-700);
        }

        .btn-outline:hover {
            background: var(--gray-50);
        }

        .btn-sm {
            padding: 0.375rem 0.875rem;
            font-size: 0.813rem;
        }

        /* Badges */
        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
        }

        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-info {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-gray {
            background: var(--gray-200);
            color: var(--gray-700);
        }

        /* Platform Badges */
        .platform-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.25rem 0.625rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .platform-mercadolivre {
            background: #fff8dc;
            color: #b8860b;
        }

        .platform-shopee {
            background: #ffe5e5;
            color: #ee4d2d;
        }

        .platform-amazon {
            background: #fff3e0;
            color: #ff9800;
        }

        .platform-magalu {
            background: #e3f2fd;
            color: #0d47a1;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border: 1px solid var(--gray-300);
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: border-color 0.2s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* Grid Layout */
        .grid {
            display: grid;
            gap: 1.5rem;
        }

        .grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        /* Alerts */
        .alert {
            padding: 1rem 1.25rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .alert-warning {
            background: #fef3c7;
            border: 1px solid #fde68a;
            color: #92400e;
        }

        .alert-danger {
            background: #fee2e2;
            border: 1px solid #fecaca;
            color: #991b1b;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-600);
        }

        /* Progress Bar */
        .progress {
            background: var(--gray-200);
            border-radius: 9999px;
            height: 8px;
            overflow: hidden;
        }

        .progress-bar {
            background: var(--primary);
            height: 100%;
            transition: width 0.3s;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Stock Level Indicator */
        .stock-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stock-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .stock-dot.high {
            background: var(--success);
        }

        .stock-dot.medium {
            background: var(--warning);
        }

        .stock-dot.low {
            background: var(--danger);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: 220px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--gray-200);
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Bar */
        .loading-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gray-200);
            z-index: 9999;
            display: none;
        }

        .loading-bar.active {
            display: block;
        }

        .loading-bar-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(37, 99, 235, 0.5);
        }

        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .loading-bar-progress.active {
            background: linear-gradient(90deg, var(--primary) 0%, var(--success) 50%, var(--primary) 100%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }

        /* Task List for Packing */
        .task-item {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .task-item:hover {
            border-color: var(--primary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .task-id {
            font-weight: 600;
            color: var(--gray-900);
        }

        .task-products {
            color: var(--gray-600);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .task-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.813rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo">
            üì¶ E-commerce Manager
        </div>
        <div class="user-info">
            <div class="notification-badge">
                üîî
                <span class="badge-count">5</span>
            </div>
            <div style="display: flex; align-items: center; gap: 0.5rem;">
                <span style="font-weight: 500;">Jo√£o Silva</span>
                <div style="width: 32px; height: 32px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
                    JS
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Bar -->
    <div class="loading-bar" id="loadingBar">
        <div class="loading-bar-progress" id="loadingBarProgress"></div>
    </div>

    <!-- Container -->
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="nav-item active" onclick="showPage('dashboard')">
                <span class="nav-icon">üìä</span>
                Dashboard
            </div>
            <div class="nav-item" onclick="showPage('orders')">
                <span class="nav-icon">üìã</span>
                Pedidos
            </div>
            <div class="nav-item" onclick="showPage('picking')">
                <span class="nav-icon">üéØ</span>
                Separa√ß√£o
            </div>
            <div class="nav-item" onclick="showPage('packing')">
                <span class="nav-icon">üì¶</span>
                Packing
            </div>
            <div class="nav-item" onclick="showPage('products')">
                <span class="nav-icon">üè∑Ô∏è</span>
                Produtos
            </div>
            <div class="nav-item" onclick="showPage('stock')">
                <span class="nav-icon">üóÉÔ∏è</span>
                Invent√°rio
            </div>
            <div class="nav-item" onclick="showPage('postos')">
                <span class="nav-icon">üè¢</span>
                Postos
            </div>
            <div class="nav-item" onclick="showPage('positions')">
                <span class="nav-icon">üìç</span>
                Posi√ß√µes
            </div>
            <div class="nav-item" onclick="showPage('purchase-orders')">
                <span class="nav-icon">üõí</span>
                Ordens de Compra
            </div>
            <div class="nav-item" onclick="showPage('platforms')">
                <span class="nav-icon">üîó</span>
                Plataformas
            </div>
            <div class="nav-item" onclick="showPage('reports')">
                <span class="nav-icon">üìä</span>
                Relat√≥rios
            </div>
            <div class="nav-item" onclick="showPage('settings')">
                <span class="nav-icon">‚öôÔ∏è</span>
                Configura√ß√µes
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <h1 style="font-size: 1.875rem; font-weight: 700; margin-bottom: 1.5rem;">Dashboard</h1>
                
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Pedidos Pendentes</div>
                            </div>
                            <div class="stat-icon" style="background: #dbeafe; color: var(--primary);">
                                üìã
                            </div>
                        </div>
                        <div class="stat-value">247</div>
                        <div class="stat-change positive">
                            ‚Üë 12% vs ontem
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Em Separa√ß√£o</div>
                            </div>
                            <div class="stat-icon" style="background: #fef3c7; color: var(--warning);">
                                üéØ
                            </div>
                        </div>
                        <div class="stat-value">89</div>
                        <div class="stat-change positive">
                            ‚Üë 5% vs ontem
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Produtos Estoque Baixo</div>
                            </div>
                            <div class="stat-icon" style="background: #fee2e2; color: var(--danger);">
                                ‚ö†Ô∏è
                            </div>
                        </div>
                        <div class="stat-value">15</div>
                        <div class="stat-change negative">
                            Requer aten√ß√£o
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Enviados Hoje</div>
                            </div>
                            <div class="stat-icon" style="background: #d1fae5; color: var(--success);">
                                ‚úÖ
                            </div>
                        </div>
                        <div class="stat-value">342</div>
                        <div class="stat-change positive">
                            ‚Üë 8% vs ontem
                        </div>
                    </div>
                </div>

                <!-- Recent Orders -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Pedidos Recentes</h2>
                        <button class="btn btn-outline btn-sm" onclick="showPage('orders'); document.querySelector('[onclick*=orders]').click();">Ver Todos</button>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID Pedido</th>
                                    <th>Plataforma</th>
                                    <th>Cliente</th>
                                    <th>Produtos</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>#ML-45892</strong></td>
                                    <td><span class="platform-badge platform-mercadolivre">üõí Mercado Livre</span></td>
                                    <td>Maria Santos</td>
                                    <td>3 itens</td>
                                    <td><span class="badge badge-warning">Pendente</span></td>
                                    <td><button class="btn btn-primary btn-sm" onclick="processOrder('#ML-45892')">‚ñ∂Ô∏è Processar</button></td>
                                </tr>
                                <tr>
                                    <td><strong>#SH-78234</strong></td>
                                    <td><span class="platform-badge platform-shopee">üõçÔ∏è Shopee</span></td>
                                    <td>Carlos Lima</td>
                                    <td>1 item</td>
                                    <td><span class="badge badge-info">Em Separa√ß√£o</span></td>
                                    <td><button class="btn btn-outline btn-sm" onclick="openModal('orderDetailsModal')">üëÅÔ∏è Ver Detalhes</button></td>
                                </tr>
                                <tr>
                                    <td><strong>#AMZ-12456</strong></td>
                                    <td><span class="platform-badge platform-amazon">üì¶ Amazon</span></td>
                                    <td>Ana Oliveira</td>
                                    <td>5 itens</td>
                                    <td><span class="badge badge-success">Separado</span></td>
                                    <td><button class="btn btn-success btn-sm" onclick="openPackingModal()">üì¶ Embalar</button></td>
                                </tr>
                                <tr>
                                    <td><strong>#MG-98765</strong></td>
                                    <td><span class="platform-badge platform-magalu">üè™ Magazine Luiza</span></td>
                                    <td>Pedro Costa</td>
                                    <td>2 itens</td>
                                    <td><span class="badge badge-warning">Pendente</span></td>
                                    <td><button class="btn btn-primary btn-sm" onclick="processOrder('#MG-98765')">‚ñ∂Ô∏è Processar</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Alerts -->
                <div class="alert alert-warning">
                    <span style="font-size: 1.5rem;">‚ö†Ô∏è</span>
                    <div>
                        <strong>15 produtos com estoque baixo</strong> - Verifique as ordens de compra sugeridas
                    </div>
                </div>
            </div>

            <!-- Orders Page -->
            <div id="orders" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h1 style="font-size: 1.875rem; font-weight: 700;">Pedidos</h1>
                    <div style="display: flex; gap: 0.75rem;">
                        <button class="btn btn-outline" onclick="openModal('importOrdersModal')">üìÑ Importar CSV</button>
                        <button class="btn btn-outline" onclick="openModal('manualOrderModal')">‚ûï Pedido Manual</button>
                        <button class="btn btn-primary" onclick="syncPlatforms()">üîÑ Sincronizar Plataformas</button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="card">
                    <div class="card-body">
                        <div class="grid grid-3">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label>Plataforma</label>
                                <select>
                                    <option>Todas</option>
                                    <option>Mercado Livre</option>
                                    <option>Shopee</option>
                                    <option>Amazon</option>
                                    <option>Magazine Luiza</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label>Status</label>
                                <select>
                                    <option>Todos</option>
                                    <option>Pendente</option>
                                    <option>Em Separa√ß√£o</option>
                                    <option>Separado</option>
                                    <option>Embalado</option>
                                    <option>Enviado</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label>Buscar</label>
                                <input type="text" placeholder="ID do pedido ou cliente...">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Orders Table -->
                <div class="card">
                    <div class="card-body" style="padding: 0;">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Plataforma</th>
                                    <th>Cliente</th>
                                    <th>Data</th>
                                    <th>Produtos</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>#ML-45892</strong></td>
                                    <td><span class="platform-badge platform-mercadolivre">üõí ML</span></td>
                                    <td>Maria Santos</td>
                                    <td>10/02/2026 14:32</td>
                                    <td>3 itens</td>
                                    <td>R$ 249,90</td>
                                    <td><span class="badge badge-warning">Pendente</span></td>
                                    <td>
                                        <button class="btn btn-primary btn-sm" onclick="processOrder('#ML-45892')">‚ñ∂Ô∏è Processar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>#SH-78234</strong></td>
                                    <td><span class="platform-badge platform-shopee">üõçÔ∏è Shopee</span></td>
                                    <td>Carlos Lima</td>
                                    <td>10/02/2026 13:15</td>
                                    <td>1 item</td>
                                    <td>R$ 89,90</td>
                                    <td><span class="badge badge-info">Em Separa√ß√£o</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="openModal('orderDetailsModal')">üëÅÔ∏è Ver Detalhes</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>#AMZ-12456</strong></td>
                                    <td><span class="platform-badge platform-amazon">üì¶ Amazon</span></td>
                                    <td>Ana Oliveira</td>
                                    <td>10/02/2026 12:08</td>
                                    <td>5 itens</td>
                                    <td>R$ 567,50</td>
                                    <td><span class="badge badge-success">Separado</span></td>
                                    <td>
                                        <button class="btn btn-success btn-sm" onclick="openPackingModal()">üì¶ Embalar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>#MG-98765</strong></td>
                                    <td><span class="platform-badge platform-magalu">üè™ Magalu</span></td>
                                    <td>Pedro Costa</td>
                                    <td>10/02/2026 11:45</td>
                                    <td>2 itens</td>
                                    <td>R$ 178,00</td>
                                    <td><span class="badge badge-warning">Pendente</span></td>
                                    <td>
                                        <button class="btn btn-primary btn-sm" onclick="processOrder('#MG-98765')">‚ñ∂Ô∏è Processar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Picking Page -->
            <div id="picking" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h1 style="font-size: 1.875rem; font-weight: 700;">Separa√ß√£o de Pedidos</h1>
                    <div style="display: flex; gap: 0.75rem;">
                        <button class="btn btn-success" onclick="openScannerMode()">üì± Modo Leitura</button>
                        <button class="btn btn-primary" onclick="openModal('newWaveModal')">üéØ Nova Onda de Separa√ß√£o</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Onda de Separa√ß√£o #WAVE-001</h2>
                        <span class="badge badge-info">Em Andamento</span>
                    </div>
                    <div class="card-body">
                        <div style="margin-bottom: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="font-size: 0.875rem; color: var(--gray-600);">Progresso: 12 de 25 itens</span>
                                <span style="font-size: 0.875rem; font-weight: 600;">48%</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar" style="width: 48%;"></div>
                            </div>
                        </div>

                        <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 1rem;">Pr√≥ximo Item:</h3>
                        
                        <div class="task-item" style="background: #eff6ff; border-color: var(--primary);">
                            <div class="task-header">
                                <div class="task-id">Produto: Camiseta Premium - Azul M</div>
                                <span class="badge badge-info">Posi√ß√£o: A-12-3</span>
                            </div>
                            <div class="task-products">
                                SKU: CAM-PREM-AZL-M | EAN: 7891234567890 | Pedido: #ML-45892
                            </div>
                            <div class="task-footer">
                                <span style="color: var(--gray-600);">Quantidade: 2 unidades</span>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn btn-success btn-sm" onclick="collectItem()">‚úÖ Item Coletado</button>
                                    <button class="btn btn-warning btn-sm" onclick="openModal('outOfStockModal')">‚ö†Ô∏è Sem Estoque</button>
                                </div>
                            </div>
                        </div>

                        <h3 style="font-size: 1rem; font-weight: 600; margin: 1.5rem 0 1rem;">Itens Restantes:</h3>
                        
                        <div class="task-item">
                            <div class="task-header">
                                <div class="task-id">Produto: T√™nis Esportivo - Preto 42</div>
                                <span class="badge badge-gray">Posi√ß√£o: B-08-2</span>
                            </div>
                            <div class="task-products">
                                SKU: TEN-ESP-PRT-42 | EAN: 7891234567891 | Pedido: #SH-78234
                            </div>
                            <div class="task-footer">
                                <span style="color: var(--gray-600);">Quantidade: 1 unidade</span>
                            </div>
                        </div>

                        <div class="task-item">
                            <div class="task-header">
                                <div class="task-id">Produto: Mochila Notebook 15"</div>
                                <span class="badge badge-gray">Posi√ß√£o: C-15-1</span>
                            </div>
                            <div class="task-products">
                                SKU: MOCH-NOTE-15 | EAN: 7891234567892 | Pedido: #AMZ-12456
                            </div>
                            <div class="task-footer">
                                <span style="color: var(--gray-600);">Quantidade: 3 unidades</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Packing Page -->
            <div id="packing" class="page">
                <h1 style="font-size: 1.875rem; font-weight: 700; margin-bottom: 1.5rem;">Packing - Embalagem</h1>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Pedidos Aguardando Embalagem</h2>
                        <span class="badge badge-info">8 pedidos</span>
                    </div>
                    <div class="card-body">
                        <div class="task-item" style="background: #eff6ff; border-color: var(--primary);">
                            <div class="task-header">
                                <div>
                                    <div class="task-id">#AMZ-12456 - Ana Oliveira</div>
                                    <span class="platform-badge platform-amazon" style="margin-top: 0.25rem;">üì¶ Amazon</span>
                                </div>
                                <span class="badge badge-success">Separado</span>
                            </div>
                            <div class="task-products">
                                5 produtos separados | Total: R$ 567,50
                            </div>
                            <div class="task-footer">
                                <span style="color: var(--gray-600);">Separado h√° 15 min</span>
                                <button class="btn btn-primary btn-sm" onclick="openPackingModal()">üì¶ Iniciar Embalagem</button>
                            </div>
                        </div>

                        <div class="task-item">
                            <div class="task-header">
                                <div>
                                    <div class="task-id">#ML-45892 - Maria Santos</div>
                                    <span class="platform-badge platform-mercadolivre" style="margin-top: 0.25rem;">üõí Mercado Livre</span>
                                </div>
                                <span class="badge badge-success">Separado</span>
                            </div>
                            <div class="task-products">
                                3 produtos separados | Total: R$ 249,90
                            </div>
                            <div class="task-footer">
                                <span style="color: var(--gray-600);">Separado h√° 32 min</span>
                                <button class="btn btn-outline btn-sm">Ver Detalhes</button>
                            </div>
                        </div>

                        <div class="task-item">
                            <div class="task-header">
                                <div>
                                    <div class="task-id">#MG-98765 - Pedro Costa</div>
                                    <span class="platform-badge platform-magalu" style="margin-top: 0.25rem;">üè™ Magazine Luiza</span>
                                </div>
                                <span class="badge badge-success">Separado</span>
                            </div>
                            <div class="task-products">
                                2 produtos separados | Total: R$ 178,00
                            </div>
                            <div class="task-footer">
                                <span style="color: var(--gray-600);">Separado h√° 1h 5min</span>
                                <button class="btn btn-outline btn-sm">Ver Detalhes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Page -->
            <div id="products" class="page">
                <h1 style="font-size: 1.875rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--gray-900);">üè∑Ô∏è Produtos</h1>
                <p style="color: var(--gray-600); margin-bottom: 2rem;">Gerencie o cadastro de produtos</p>

                <div class="card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">Lista de Produtos</h2>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-top: 0.25rem;">Cadastre e edite informa√ß√µes dos produtos</p>
                        </div>
                        <button class="btn btn-primary" onclick="openModal('addProductModal')">
                            <span>‚ûï</span>
                            Novo Produto
                        </button>
                    </div>
                    <div class="card-body" style="padding: 0; overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>SKU</th>
                                    <th>Nome do Produto</th>
                                    <th>EAN/C√≥digo de Barras</th>
                                    <th>Categoria</th>
                                    <th>Pre√ßo</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>SKU001</strong></td>
                                    <td>Mouse Gamer RGB</td>
                                    <td>7891234567890</td>
                                    <td><span class="badge badge-info">Eletr√¥nicos</span></td>
                                    <td>R$ 149,90</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="openEditProductModal('SKU001')">‚úèÔ∏è Editar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>SKU002</strong></td>
                                    <td>Teclado Mec√¢nico</td>
                                    <td>7891234567891</td>
                                    <td><span class="badge badge-info">Eletr√¥nicos</span></td>
                                    <td>R$ 299,90</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="openEditProductModal('SKU002')">‚úèÔ∏è Editar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>SKU003</strong></td>
                                    <td>Monitor 24" Full HD</td>
                                    <td>7891234567892</td>
                                    <td><span class="badge badge-info">Eletr√¥nicos</span></td>
                                    <td>R$ 799,90</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="openEditProductModal('SKU003')">‚úèÔ∏è Editar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Stock Page -->
            <div id="stock" class="page">
                <h1 style="font-size: 1.875rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--gray-900);">üóÉÔ∏è Invent√°rio</h1>
                <p style="color: var(--gray-600); margin-bottom: 2rem;">Saldos por posi√ß√£o (Picking, Pulm√£o e Estoque) com alertas de reabastecimento</p>

                <!-- Alert de Estoque Baixo -->
                <div class="alert alert-warning" style="margin-bottom: 1.5rem;">
                    <span style="font-size: 1.5rem;">‚ö†Ô∏è</span>
                    <div>
                        <strong>15 produtos abaixo do estoque m√≠nimo</strong>
                        <div style="font-size: 0.875rem; margin-top: 0.25rem;">Ordens de compra foram geradas automaticamente</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">Saldos por Posi√ß√£o</h2>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-top: 0.25rem;">Controle de saldos: Produto + Posi√ß√£o + Limites</p>
                        </div>
                        <div style="display: flex; gap: 0.75rem;">
                            <button class="btn btn-outline" onclick="openModal('importStockModal')">
                                <span>üìÑ</span>
                                Importar CSV
                            </button>
                            <button class="btn btn-primary" onclick="openModal('addStockModal')">
                                <span>‚ûï</span>
                                Novo Saldo
                            </button>
                        </div>
                    </div>
                    <div class="card-body" style="padding: 0; overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>SKU</th>
                                    <th>Produto</th>
                                    <th>Posi√ß√£o</th>
                                    <th>Tipo</th>
                                    <th>Saldo Atual</th>
                                    <th>M√≠n / M√°x</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>SKU001</strong></td>
                                    <td>Mouse Gamer RGB</td>
                                    <td><code>E-01-1</code></td>
                                    <td><span style="padding: 0.25rem 0.5rem; background: #dbeafe; color: #1e40af; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600;">üè™ ESTOQUE</span></td>
                                    <td><strong>450</strong> un.</td>
                                    <td>100 / 1000</td>
                                    <td><span class="badge badge-success">‚úì OK</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="editStock('SKU001', 'E-01-1')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-primary" onclick="openRestoreStockModal('SKU001', 'E-01-1')">üì¶ Restaurar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>SKU001</strong></td>
                                    <td>Mouse Gamer RGB</td>
                                    <td><code>P-01-2</code></td>
                                    <td><span style="padding: 0.25rem 0.5rem; background: #fef3c7; color: #92400e; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600;">üì¶ PULM√ÉO</span></td>
                                    <td><strong>18</strong> un.</td>
                                    <td>20 / 50</td>
                                    <td><span class="badge badge-warning">‚ö†Ô∏è BAIXO</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="editStock('SKU001', 'P-01-2')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-warning" onclick="openReplenishmentModal('SKU001', 'P-01-2')">üîÑ Abastecer</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>SKU001</strong></td>
                                    <td>Mouse Gamer RGB</td>
                                    <td><code>PK-01-1</code></td>
                                    <td><span style="padding: 0.25rem 0.5rem; background: #d1fae5; color: #065f46; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600;">üéØ PICKING</span></td>
                                    <td><strong>5</strong> un.</td>
                                    <td>10 / 30</td>
                                    <td><span class="badge badge-danger">üî¥ CR√çTICO</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="editStock('SKU001', 'PK-01-1')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-warning" onclick="openReplenishmentModal('SKU001', 'PK-01-1')">üîÑ Abastecer</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>SKU002</strong></td>
                                    <td>Teclado Mec√¢nico</td>
                                    <td><code>E-01-2</code></td>
                                    <td><span style="padding: 0.25rem 0.5rem; background: #dbeafe; color: #1e40af; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600;">üè™ ESTOQUE</span></td>
                                    <td><strong>280</strong> un.</td>
                                    <td>50 / 500</td>
                                    <td><span class="badge badge-success">‚úì OK</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="editStock('SKU002', 'E-01-2')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-primary" onclick="openRestoreStockModal('SKU002', 'E-01-2')">üì¶ Restaurar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>SKU002</strong></td>
                                    <td>Teclado Mec√¢nico</td>
                                    <td><code>PK-02-1</code></td>
                                    <td><span style="padding: 0.25rem 0.5rem; background: #d1fae5; color: #065f46; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600;">üéØ PICKING</span></td>
                                    <td><strong>22</strong> un.</td>
                                    <td>15 / 40</td>
                                    <td><span class="badge badge-success">‚úì OK</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="editStock('SKU002', 'PK-02-1')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-outline" onclick="openReplenishmentModal('SKU002', 'PK-02-1')">üîÑ</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>SKU003</strong></td>
                                    <td>Monitor 24" Full HD</td>
                                    <td><code>E-02-1</code></td>
                                    <td><span style="padding: 0.25rem 0.5rem; background: #dbeafe; color: #1e40af; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600;">üè™ ESTOQUE</span></td>
                                    <td><strong>120</strong> un.</td>
                                    <td>30 / 200</td>
                                    <td><span class="badge badge-success">‚úì OK</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline" onclick="editStock('SKU003', 'E-02-1')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-primary" onclick="openRestoreStockModal('SKU003', 'E-02-1')">üì¶ Restaurar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Postos Page -->
            <div id="postos" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h1 style="font-size: 1.875rem; font-weight: 700;">Gest√£o de Postos e Supostos</h1>
                    <button class="btn btn-primary" onclick="openModal('addPostoModal')">‚ûï Criar Posto</button>
                </div>

                <div class="card" style="margin-bottom: 1.5rem;">
                    <div class="card-body">
                        <div style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: 0.5rem; padding: 1rem;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; font-size: 0.875rem;">
                                <div>
                                    <div style="font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem;">POSTO</div>
                                    <div>Corredor (A, B, C...)</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem;">SUPOSTO</div>
                                    <div>Prateleira (01, 02...)</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem;">TIPO</div>
                                    <div>Finalidade do posto</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem;">SEQU√äNCIA</div>
                                    <div>Ordem de organiza√ß√£o</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Postos Table -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Postos Cadastrados</h2>
                        <div style="display: flex; gap: 0.75rem;">
                            <button class="btn btn-outline btn-sm">üìä Exportar</button>
                            <button class="btn btn-outline btn-sm">üîÑ Atualizar</button>
                        </div>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Posto</th>
                                    <th>Tipo</th>
                                    <th>Sequ√™ncia</th>
                                    <th>Supostos</th>
                                    <th>Total Posi√ß√µes</th>
                                    <th>Criado em</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong style="font-size: 1.125rem; color: var(--primary);">A</strong></td>
                                    <td><span class="badge" style="background: #dcfce7; color: #166534;">üè™ ESTOQUE</span></td>
                                    <td><span class="badge badge-gray">1</span></td>
                                    <td>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                            <span class="badge badge-outline">01</span>
                                            <span class="badge badge-outline">02</span>
                                            <span class="badge badge-outline">03</span>
                                            <span class="badge badge-outline">04</span>
                                            <span class="badge badge-outline">05</span>
                                        </div>
                                    </td>
                                    <td><strong>25</strong> posi√ß√µes</td>
                                    <td>10/02/2026</td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosto('A')">‚úèÔ∏è Editar</button>
                                        <button class="btn btn-outline btn-sm" style="color: var(--danger);" onclick="deletePosto('A')">üóëÔ∏è</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong style="font-size: 1.125rem; color: var(--primary);">E</strong></td>
                                    <td><span class="badge" style="background: #dcfce7; color: #166534;">üè™ ESTOQUE</span></td>
                                    <td><span class="badge badge-gray">2</span></td>
                                    <td>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                            <span class="badge badge-outline">01</span>
                                            <span class="badge badge-outline">02</span>
                                            <span class="badge badge-outline">03</span>
                                        </div>
                                    </td>
                                    <td><strong>15</strong> posi√ß√µes</td>
                                    <td>10/02/2026</td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosto('E')">‚úèÔ∏è Editar</button>
                                        <button class="btn btn-outline btn-sm" style="color: var(--danger);" onclick="deletePosto('E')">üóëÔ∏è</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong style="font-size: 1.125rem; color: var(--primary);">P</strong></td>
                                    <td><span class="badge" style="background: #fef3c7; color: #854d0e;">üì¶ PULM√ÉO</span></td>
                                    <td><span class="badge badge-gray">3</span></td>
                                    <td>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                            <span class="badge badge-outline">01</span>
                                            <span class="badge badge-outline">02</span>
                                        </div>
                                    </td>
                                    <td><strong>10</strong> posi√ß√µes</td>
                                    <td>10/02/2026</td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosto('P')">‚úèÔ∏è Editar</button>
                                        <button class="btn btn-outline btn-sm" style="color: var(--danger);" onclick="deletePosto('P')">üóëÔ∏è</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong style="font-size: 1.125rem; color: var(--primary);">B</strong></td>
                                    <td><span class="badge" style="background: #dbeafe; color: #1e40af;">üéØ PICKING</span></td>
                                    <td><span class="badge badge-gray">4</span></td>
                                    <td>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                            <span class="badge badge-outline">12</span>
                                            <span class="badge badge-outline">15</span>
                                            <span class="badge badge-outline">08</span>
                                        </div>
                                    </td>
                                    <td><strong>18</strong> posi√ß√µes</td>
                                    <td>10/02/2026</td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosto('B')">‚úèÔ∏è Editar</button>
                                        <button class="btn btn-outline btn-sm" style="color: var(--danger);" onclick="deletePosto('B')">üóëÔ∏è</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Positions Page -->
            <div id="positions" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h1 style="font-size: 1.875rem; font-weight: 700;">Gest√£o de Posi√ß√µes</h1>
                    <div style="display: flex; gap: 0.75rem;">
                        <button class="btn btn-outline" onclick="openModal('importPositionsModal')">üìÑ Importar CSV</button>
                        <button class="btn btn-primary" onclick="resetPositionModal(); openModal('addPositionModal')">‚ûï Criar Posi√ß√£o</button>
                    </div>
                </div>

                <div class="card" style="margin-bottom: 1.5rem;">
                    <div class="card-body">
                        <div style="background: #eff6ff; border-left: 4px solid var(--primary); padding: 1rem; border-radius: 0.5rem;">
                            <div style="font-weight: 600; margin-bottom: 0.25rem; color: var(--primary);">üí° Como Funciona</div>
                            <div style="font-size: 0.875rem; color: var(--gray-700);">
                                <strong>Posto</strong> ‚Üí Corredor principal (ex: A, B, C)<br>
                                <strong>Suposto</strong> ‚Üí Prateleira dentro do posto (ex: 01, 02, 03)<br>
                                <strong>Posi√ß√£o</strong> ‚Üí Local espec√≠fico na prateleira (ex: 1, 2, 3)<br>
                                <strong>Formato final:</strong> A-01-1 (Posto-Suposto-Posi√ß√£o)
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Positions Table -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Posi√ß√µes Cadastradas</h2>
                        <div style="display: flex; gap: 0.75rem;">
                            <button class="btn btn-outline btn-sm">üìä Exportar</button>
                            <button class="btn btn-outline btn-sm">üîÑ Atualizar</button>
                        </div>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table>
                            <thead>
                                <tr>
                                    <th>C√≥digo Completo</th>
                                    <th>Posto</th>
                                    <th>Suposto</th>
                                    <th>Posi√ß√£o</th>
                                    <th>Tipo</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>A-12-3</strong></td>
                                    <td>A</td>
                                    <td>12</td>
                                    <td>3</td>
                                    <td><span class="badge badge-info">Picking</span></td>
                                    <td><span class="badge badge-success">Ocupada</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosition('A-12-3')">Editar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>A-12-4</strong></td>
                                    <td>A</td>
                                    <td>12</td>
                                    <td>4</td>
                                    <td><span class="badge badge-info">Picking</span></td>
                                    <td><span class="badge badge-gray">Livre</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosition('A-12-4')">Editar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>B-08-2</strong></td>
                                    <td>B</td>
                                    <td>08</td>
                                    <td>2</td>
                                    <td><span class="badge badge-warning">Reserva</span></td>
                                    <td><span class="badge badge-success">Ocupada</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosition('B-08-2')">Editar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>C-15-1</strong></td>
                                    <td>C</td>
                                    <td>15</td>
                                    <td>1</td>
                                    <td><span class="badge badge-info">Picking</span></td>
                                    <td><span class="badge badge-success">Ocupada</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="editPosition('C-15-1')">Editar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Purchase Orders Page -->
            <div id="purchase-orders" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h1 style="font-size: 1.875rem; font-weight: 700;">Ordens de Compra</h1>
                    <button class="btn btn-primary" onclick="openModal('newPOModal')">‚ûï Nova Ordem de Compra</button>
                </div>

                <!-- Suggested POs -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Ordens Sugeridas (Estoque M√≠nimo)</h2>
                        <span class="badge badge-warning">5 pendentes</span>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Produto</th>
                                    <th>Estoque Atual</th>
                                    <th>Estoque M√≠n.</th>
                                    <th>Qtd. Sugerida</th>
                                    <th>Fornecedor</th>
                                    <th>Custo Est.</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Mochila Notebook 15"</strong></td>
                                    <td><span class="badge badge-danger">8 un</span></td>
                                    <td>20 un</td>
                                    <td><strong>50 un</strong></td>
                                    <td>Fornecedor ABC</td>
                                    <td>R$ 1.875,00</td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="openModal('editPOModal')">‚úèÔ∏è Editar</button>
                                        <button class="btn btn-success btn-sm" onclick="approvePO()">‚úÖ Aprovar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Rel√≥gio Smartwatch Preto</strong></td>
                                    <td><span class="badge badge-danger">4 un</span></td>
                                    <td>15 un</td>
                                    <td><strong>30 un</strong></td>
                                    <td>Tech Imports</td>
                                    <td>R$ 4.200,00</td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="openModal('editPOModal')">‚úèÔ∏è Editar</button>
                                        <button class="btn btn-success btn-sm" onclick="approvePO()">‚úÖ Aprovar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Fone Bluetooth Sport</strong></td>
                                    <td><span class="badge badge-danger">6 un</span></td>
                                    <td>25 un</td>
                                    <td><strong>60 un</strong></td>
                                    <td>Eletr√¥nicos XYZ</td>
                                    <td>R$ 1.680,00</td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="openModal('editPOModal')">‚úèÔ∏è Editar</button>
                                        <button class="btn btn-success btn-sm" onclick="approvePO()">‚úÖ Aprovar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Active POs -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <h2 class="card-title">Ordens Ativas</h2>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Fornecedor</th>
                                    <th>Data</th>
                                    <th>Produtos</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>PO-2024-001</strong></td>
                                    <td>Fornecedor ABC</td>
                                    <td>05/02/2026</td>
                                    <td>3 itens (150 un)</td>
                                    <td>R$ 8.450,00</td>
                                    <td><span class="badge badge-info">Em Tr√¢nsito</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="openModal('poDetailsModal')">üëÅÔ∏è Ver Detalhes</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>PO-2024-002</strong></td>
                                    <td>Tech Imports</td>
                                    <td>08/02/2026</td>
                                    <td>5 itens (200 un)</td>
                                    <td>R$ 12.300,00</td>
                                    <td><span class="badge badge-warning">Aguardando</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="openModal('poDetailsModal')">üëÅÔ∏è Ver Detalhes</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Platforms Page -->
            <div id="platforms" class="page">
                <h1 style="font-size: 1.875rem; font-weight: 700; margin-bottom: 1.5rem;">Integra√ß√µes com Plataformas</h1>

                <div class="grid grid-2">
                    <!-- Mercado Livre -->
                    <div class="card">
                        <div class="card-body">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div>
                                    <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üõí</div>
                                    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.25rem;">Mercado Livre</h3>
                                    <p style="color: var(--gray-600); font-size: 0.875rem;">Sincronizado h√° 5 min</p>
                                </div>
                                <span class="badge badge-success">Conectado</span>
                            </div>
                            <div style="padding: 1rem; background: var(--gray-50); border-radius: 0.5rem; margin-bottom: 1rem;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Pedidos hoje:</span>
                                    <strong>47</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Produtos ativos:</span>
                                    <strong>342</strong>
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-outline btn-sm" onclick="syncPlatform('Mercado Livre')">üîÑ Sincronizar</button>
                                <button class="btn btn-outline btn-sm" onclick="openModal('platformConfigModal')">‚öôÔ∏è Configurar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Shopee -->
                    <div class="card">
                        <div class="card-body">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div>
                                    <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üõçÔ∏è</div>
                                    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.25rem;">Shopee</h3>
                                    <p style="color: var(--gray-600); font-size: 0.875rem;">Sincronizado h√° 3 min</p>
                                </div>
                                <span class="badge badge-success">Conectado</span>
                            </div>
                            <div style="padding: 1rem; background: var(--gray-50); border-radius: 0.5rem; margin-bottom: 1rem;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Pedidos hoje:</span>
                                    <strong>32</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Produtos ativos:</span>
                                    <strong>298</strong>
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-outline btn-sm" onclick="syncPlatform('Shopee')">üîÑ Sincronizar</button>
                                <button class="btn btn-outline btn-sm" onclick="openModal('platformConfigModal')">‚öôÔ∏è Configurar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Amazon -->
                    <div class="card">
                        <div class="card-body">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div>
                                    <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üì¶</div>
                                    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.25rem;">Amazon</h3>
                                    <p style="color: var(--gray-600); font-size: 0.875rem;">Sincronizado h√° 2 min</p>
                                </div>
                                <span class="badge badge-success">Conectado</span>
                            </div>
                            <div style="padding: 1rem; background: var(--gray-50); border-radius: 0.5rem; margin-bottom: 1rem;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Pedidos hoje:</span>
                                    <strong>58</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Produtos ativos:</span>
                                    <strong>412</strong>
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-outline btn-sm" onclick="syncPlatform('Amazon')">üîÑ Sincronizar</button>
                                <button class="btn btn-outline btn-sm" onclick="openModal('platformConfigModal')">‚öôÔ∏è Configurar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Magazine Luiza -->
                    <div class="card">
                        <div class="card-body">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div>
                                    <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üè™</div>
                                    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.25rem;">Magazine Luiza</h3>
                                    <p style="color: var(--gray-600); font-size: 0.875rem;">Sincronizado h√° 8 min</p>
                                </div>
                                <span class="badge badge-success">Conectado</span>
                            </div>
                            <div style="padding: 1rem; background: var(--gray-50); border-radius: 0.5rem; margin-bottom: 1rem;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Pedidos hoje:</span>
                                    <strong>23</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: var(--gray-600); font-size: 0.875rem;">Produtos ativos:</span>
                                    <strong>267</strong>
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-outline btn-sm" onclick="syncPlatform('Magazine Luiza')">üîÑ Sincronizar</button>
                                <button class="btn btn-outline btn-sm" onclick="openModal('platformConfigModal')">‚öôÔ∏è Configurar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add New Platform -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-body" style="text-align: center; padding: 3rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">‚ûï</div>
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">Adicionar Nova Plataforma</h3>
                        <p style="color: var(--gray-600); margin-bottom: 1.5rem;">Conecte mais marketplaces ao seu sistema</p>
                        <button class="btn btn-primary" onclick="openModal('addPlatformModal')">Conectar Plataforma</button>
                    </div>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="reports" class="page">
                <h1 style="font-size: 1.875rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--gray-900);">üìä Relat√≥rios</h1>
                <p style="color: var(--gray-600); margin-bottom: 2rem;">An√°lise e insights sobre opera√ß√µes do armaz√©m</p>

                <!-- Filtros Globais -->
                <div class="card" style="margin-bottom: 1.5rem;">
                    <div class="card-body">
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: end;">
                            <div style="flex: 1; min-width: 200px;">
                                <label style="font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; display: block;">üìÖ Per√≠odo</label>
                                <select style="width: 100%;">
                                    <option>Hoje</option>
                                    <option>Ontem</option>
                                    <option selected>√öltimos 7 dias</option>
                                    <option>√öltimos 30 dias</option>
                                    <option>Este m√™s</option>
                                    <option>M√™s passado</option>
                                    <option>Personalizado</option>
                                </select>
                            </div>
                            <div style="flex: 1; min-width: 200px;">
                                <label style="font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; display: block;">üè™ Posto</label>
                                <select style="width: 100%;">
                                    <option selected>Todos os postos</option>
                                    <option>E-01 (Estoque)</option>
                                    <option>P-01 (Pulm√£o)</option>
                                    <option>PK-01 (Picking)</option>
                                </select>
                            </div>
                            <div style="flex: 1; min-width: 200px;">
                                <label style="font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; display: block;">üîó Plataforma</label>
                                <select style="width: 100%;">
                                    <option selected>Todas as plataformas</option>
                                    <option>Mercado Livre</option>
                                    <option>Shopee</option>
                                    <option>Amazon</option>
                                </select>
                            </div>
                            <button class="btn btn-primary">üîç Filtrar</button>
                            <button class="btn btn-outline">üìÑ Exportar Tudo</button>
                        </div>
                    </div>
                </div>

                <!-- Cards de M√©tricas Principais -->
                <div class="stats-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Pedidos Processados</div>
                                <div class="stat-value" style="color: white;">1.247</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(255,255,255,0.2); color: white;">
                                <span style="font-size: 1.5rem;">üì¶</span>
                            </div>
                        </div>
                        <div class="stat-change positive" style="color: rgba(255,255,255,0.9);">
                            <span>‚Üë</span> 12.5% vs per√≠odo anterior
                        </div>
                    </div>

                    <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Itens Separados</div>
                                <div class="stat-value" style="color: white;">3.891</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(255,255,255,0.2); color: white;">
                                <span style="font-size: 1.5rem;">üéØ</span>
                            </div>
                        </div>
                        <div class="stat-change positive" style="color: rgba(255,255,255,0.9);">
                            <span>‚Üë</span> 8.3% vs per√≠odo anterior
                        </div>
                    </div>

                    <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Acur√°cia</div>
                                <div class="stat-value" style="color: white;">98.7%</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(255,255,255,0.2); color: white;">
                                <span style="font-size: 1.5rem;">‚úÖ</span>
                            </div>
                        </div>
                        <div class="stat-change positive" style="color: rgba(255,255,255,0.9);">
                            <span>‚Üë</span> 0.3% vs per√≠odo anterior
                        </div>
                    </div>

                    <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white;">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Tempo M√©dio</div>
                                <div class="stat-value" style="color: white;">4.2min</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(255,255,255,0.2); color: white;">
                                <span style="font-size: 1.5rem;">‚è±Ô∏è</span>
                            </div>
                        </div>
                        <div class="stat-change positive" style="color: rgba(255,255,255,0.9);">
                            <span>‚Üì</span> 15% mais r√°pido
                        </div>
                    </div>
                </div>

                <!-- Relat√≥rios Dispon√≠veis -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <!-- Sa√≠das por Posto -->
                    <div class="card" style="cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="openReportModal('exits-by-posto')">
                        <div class="card-body">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; color: white; flex-shrink: 0;">
                                    üè™
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-900);">Sa√≠das por Posto</h3>
                                    <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.75rem;">An√°lise de movimenta√ß√µes e sa√≠das por posto e suposto</p>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                        <span class="badge badge-info">Movimenta√ß√µes</span>
                                        <span class="badge badge-gray">Gr√°fico</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sa√≠das de Produtos -->
                    <div class="card" style="cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="openReportModal('product-exits')">
                        <div class="card-body">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; color: white; flex-shrink: 0;">
                                    üì¶
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-900);">Sa√≠das de Produtos</h3>
                                    <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.75rem;">Produtos mais vendidos e movimentados no per√≠odo</p>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                        <span class="badge badge-success">Top Vendas</span>
                                        <span class="badge badge-gray">Ranking</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Produtividade de Operadores -->
                    <div class="card" style="cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="openReportModal('operator-productivity')">
                        <div class="card-body">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; color: white; flex-shrink: 0;">
                                    üë•
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-900);">Produtividade de Operadores</h3>
                                    <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.75rem;">Performance individual e m√©tricas de efici√™ncia</p>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                        <span class="badge badge-warning">Performance</span>
                                        <span class="badge badge-gray">Compara√ß√£o</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- An√°lise por Plataforma -->
                    <div class="card" style="cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="openReportModal('platform-analysis')">
                        <div class="card-body">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; color: white; flex-shrink: 0;">
                                    üîó
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-900);">An√°lise por Plataforma</h3>
                                    <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.75rem;">Desempenho e volume de vendas por marketplace</p>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                        <span class="badge badge-info">Vendas</span>
                                        <span class="badge badge-gray">Pizza</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Taxa de Ocupa√ß√£o -->
                    <div class="card" style="cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="openReportModal('occupation-rate')">
                        <div class="card-body">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; color: white; flex-shrink: 0;">
                                    üìä
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-900);">Taxa de Ocupa√ß√£o</h3>
                                    <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.75rem;">Utiliza√ß√£o de capacidade das posi√ß√µes de estoque</p>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                        <span class="badge badge-success">Capacidade</span>
                                        <span class="badge badge-gray">Barra</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tempo M√©dio de Separa√ß√£o -->
                    <div class="card" style="cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="openReportModal('picking-time')">
                        <div class="card-body">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; color: #374151; flex-shrink: 0;">
                                    ‚è±Ô∏è
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-900);">Tempo M√©dio de Separa√ß√£o</h3>
                                    <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.75rem;">An√°lise temporal das opera√ß√µes de picking</p>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                        <span class="badge badge-warning">Tempo</span>
                                        <span class="badge badge-gray">Linha</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settings" class="page">
                <h1 style="font-size: 1.875rem; font-weight: 700; margin-bottom: 1.5rem;">Configura√ß√µes</h1>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Configura√ß√µes de Estoque</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label>Margem de Estoque M√≠nimo (%)</label>
                            <input type="number" value="20" placeholder="Ex: 20">
                            <p style="font-size: 0.813rem; color: var(--gray-600); margin-top: 0.25rem;">
                                Porcentagem do estoque m√©dio para considerar como m√≠nimo
                            </p>
                        </div>

                        <div class="form-group">
                            <label>Dias para Reposi√ß√£o</label>
                            <input type="number" value="7" placeholder="Ex: 7">
                            <p style="font-size: 0.813rem; color: var(--gray-600); margin-top: 0.25rem;">
                                Tempo m√©dio de reposi√ß√£o do fornecedor
                            </p>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                                Gerar ordens de compra automaticamente
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                                Enviar alertas de estoque baixo
                            </label>
                        </div>

                        <button class="btn btn-primary">Salvar Configura√ß√µes</button>
                    </div>
                </div>

                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <h2 class="card-title">Sincroniza√ß√£o de Plataformas</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label>Intervalo de Sincroniza√ß√£o (minutos)</label>
                            <input type="number" value="5" placeholder="Ex: 5">
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                                Sincronizar estoque automaticamente
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                                Atualizar pre√ßos automaticamente
                            </label>
                        </div>

                        <button class="btn btn-primary">Salvar Configura√ß√µes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Packing Modal -->
    <div id="packingModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">Embalar Pedido #AMZ-12456</h2>
                <button class="close-modal" onclick="closeModal('packingModal')">√ó</button>
            </div>
            <div style="margin-bottom: 1.5rem;">
                <h3 style="font-weight: 600; margin-bottom: 0.75rem;">Cliente: Ana Oliveira</h3>
                <p style="color: var(--gray-600); font-size: 0.875rem;">
                    Endere√ßo: Rua das Flores, 123 - S√£o Paulo, SP
                </p>
            </div>

            <!-- Boxes Section -->
            <div id="boxesContainer" style="margin-bottom: 1.5rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                    <h3 style="font-weight: 600;">Caixas de Embalagem</h3>
                    <button class="btn btn-outline btn-sm" onclick="addBox()">‚ûï Adicionar Caixa</button>
                </div>
                
                <div id="boxesList">
                    <!-- Caixa 1 -->
                    <div class="box-item" data-box="1" style="border: 2px solid var(--primary); border-radius: 0.5rem; padding: 1rem; margin-bottom: 0.75rem; background: #eff6ff;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                            <strong style="color: var(--primary); font-size: 1.1rem;">üì¶ Caixa 1</strong>
                            <button class="btn btn-outline btn-sm" onclick="removeBox(1)" style="padding: 0.25rem 0.5rem;">‚ùå</button>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 0.75rem;">
                            <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-700);">Produtos nesta caixa:</div>
                            <label style="display: flex; align-items: center; margin-bottom: 0.5rem; cursor: pointer;">
                                <input type="checkbox" class="product-checkbox" data-product="mochila" data-box="1" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                                <span>Mochila Notebook 15" - 1x</span>
                            </label>
                            <label style="display: flex; align-items: center; margin-bottom: 0.5rem; cursor: pointer;">
                                <input type="checkbox" class="product-checkbox" data-product="mouse" data-box="1" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                                <span>Mouse Sem Fio - 2x</span>
                            </label>
                            <label style="display: flex; align-items: center; margin-bottom: 0.5rem; cursor: pointer;">
                                <input type="checkbox" class="product-checkbox" data-product="teclado" data-box="1" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                                <span>Teclado Mec√¢nico - 1x</span>
                            </label>
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" class="product-checkbox" data-product="mousepad" data-box="1" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                                <span>Mousepad Gamer - 1x</span>
                            </label>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 0.75rem;">
                            <label>Tipo de Embalagem</label>
                            <select>
                                <option>Caixa Pequena (20x15x10cm)</option>
                                <option>Caixa M√©dia (30x25x15cm)</option>
                                <option selected>Caixa Grande (40x35x20cm)</option>
                                <option>Envelope Pl√°stico</option>
                            </select>
                        </div>

                        <div class="grid grid-2">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label>Peso (kg)</label>
                                <input type="number" step="0.1" value="2.5" placeholder="0.0">
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label>C√≥digo de Rastreio</label>
                                <input type="text" placeholder="BR123456789BR">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Observa√ß√µes Gerais</label>
                <textarea rows="2" placeholder="Adicione observa√ß√µes sobre a embalagem..."></textarea>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('packingModal')">Cancelar</button>
                <button class="btn btn-success" onclick="finishPacking()">‚úÖ Finalizar Embalagem</button>
            </div>
        </div>
    </div>

    <!-- New Purchase Order Modal -->
    <div id="newPOModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Ordem de Compra</h2>
                <button class="close-modal" onclick="closeModal('newPOModal')">√ó</button>
            </div>

            <div class="form-group">
                <label>Fornecedor</label>
                <select>
                    <option>Selecione um fornecedor</option>
                    <option>Fornecedor ABC</option>
                    <option>Tech Imports</option>
                    <option>Eletr√¥nicos XYZ</option>
                </select>
            </div>

            <div class="form-group">
                <label>Produto</label>
                <select>
                    <option>Selecione um produto</option>
                    <option>Mochila Notebook 15"</option>
                    <option>Rel√≥gio Smartwatch Preto</option>
                    <option>Fone Bluetooth Sport</option>
                </select>
            </div>

            <div class="grid grid-2">
                <div class="form-group">
                    <label>Quantidade</label>
                    <input type="number" placeholder="0">
                </div>
                <div class="form-group">
                    <label>Pre√ßo Unit√°rio</label>
                    <input type="number" step="0.01" placeholder="0.00">
                </div>
            </div>

            <div class="form-group">
                <label>Data de Entrega Prevista</label>
                <input type="date">
            </div>

            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea rows="3" placeholder="Adicione observa√ß√µes..."></textarea>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('newPOModal')">Cancelar</button>
                <button class="btn btn-primary">Criar Ordem</button>
            </div>
        </div>
    </div>

    <!-- Scanner Mode Modal -->
    <div id="scannerModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%); color: white; border-radius: 0.75rem 0.75rem 0 0; margin: -2rem -2rem 1.5rem -2rem; padding: 1.5rem;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 48px; height: 48px; background: rgba(255,255,255,0.2); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; backdrop-filter: blur(10px);">
                        üì∑
                    </div>
                    <div>
                        <h2 class="modal-title" style="margin: 0; color: white; font-size: 1.25rem;">Scanner de C√≥digo</h2>
                        <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem; color: rgba(255,255,255,0.9);" id="scannerSubtitle">Aponte para o c√≥digo de barras</p>
                    </div>
                </div>
                <button class="close-modal" onclick="closeScannerModal()" style="color: white; opacity: 0.9;">√ó</button>
            </div>
            
            <div style="text-align: center; margin-bottom: 1.5rem;">
                <div style="position: relative; display: inline-block; margin-bottom: 1rem;">
                    <div style="width: 200px; height: 200px; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 1rem; display: flex; align-items: center; justify-content: center; border: 3px dashed #3b82f6; position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, transparent 0%, #3b82f6 50%, transparent 100%); animation: scan 2s ease-in-out infinite;"></div>
                        <div style="font-size: 5rem;">üì±</div>
                    </div>
                </div>
                
                <div style="background: white; border: 2px solid #e5e7eb; border-radius: 0.75rem; padding: 1rem; margin-bottom: 1rem;">
                    <label style="font-size: 0.75rem; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem; display: block;">Digite ou bip–µ o c√≥digo</label>
                    <input 
                        type="text" 
                        id="scannerInput" 
                        placeholder="C√≥digo de barras ou posi√ß√£o..." 
                        style="text-align: center; font-size: 1.5rem; font-weight: 700; border: none; width: 100%; outline: none; color: #1f2937; font-family: 'Courier New', monospace;"
                        autofocus
                    >
                </div>
            </div>

            <div id="scannerContext" style="background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%); padding: 1rem; border-radius: 0.75rem; margin-bottom: 1rem; border: 2px solid #e5e7eb;">
                <div style="font-size: 0.75rem; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem;">Contexto</div>
                <div id="scannerContextText" style="color: #374151; font-weight: 500;">Aguardando leitura...</div>
            </div>

            <div id="scannerFeedback" style="display: none; padding: 1rem; border-radius: 0.75rem; margin-bottom: 1rem;">
            </div>

            <div style="display: flex; gap: 0.75rem;">
                <button class="btn btn-outline" style="flex: 1;" onclick="closeScannerModal()">Cancelar</button>
                <button class="btn btn-primary" style="flex: 1;" onclick="processScannerInput()">‚úì Confirmar</button>
            </div>
        </div>
    </div>

    <style>
        @keyframes scan {
            0% { transform: translateY(0); }
            50% { transform: translateY(200px); }
            100% { transform: translateY(0); }
        }
    </style>

    <!-- New Wave Modal -->
    <div id="newWaveModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Onda de Separa√ß√£o</h2>
                <button class="close-modal" onclick="closeModal('newWaveModal')">√ó</button>
            </div>

            <div class="form-group">
                <label>Nome/ID da Onda</label>
                <input type="text" value="WAVE-002" placeholder="Ex: WAVE-002">
            </div>

            <div class="form-group">
                <label>Selecionar Pedidos</label>
                <div style="border: 1px solid var(--gray-300); border-radius: 0.5rem; padding: 1rem; max-height: 300px; overflow-y: auto;">
                    <label style="display: flex; align-items: center; margin-bottom: 0.75rem; cursor: pointer;">
                        <input type="checkbox" checked style="width: auto; margin-right: 0.75rem;">
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">#ML-45892 - Maria Santos</div>
                            <div style="font-size: 0.813rem; color: var(--gray-600);">3 itens | R$ 249,90</div>
                        </div>
                    </label>
                    <label style="display: flex; align-items: center; margin-bottom: 0.75rem; cursor: pointer;">
                        <input type="checkbox" checked style="width: auto; margin-right: 0.75rem;">
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">#SH-78234 - Carlos Lima</div>
                            <div style="font-size: 0.813rem; color: var(--gray-600);">1 item | R$ 89,90</div>
                        </div>
                    </label>
                    <label style="display: flex; align-items: center; margin-bottom: 0.75rem; cursor: pointer;">
                        <input type="checkbox" style="width: auto; margin-right: 0.75rem;">
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">#MG-98765 - Pedro Costa</div>
                            <div style="font-size: 0.813rem; color: var(--gray-600);">2 itens | R$ 178,00</div>
                        </div>
                    </label>
                </div>
            </div>

            <div class="grid grid-2">
                <div class="form-group">
                    <label>Prioridade</label>
                    <select>
                        <option>Normal</option>
                        <option>Alta</option>
                        <option selected>Urgente</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Atribuir a</label>
                    <select>
                        <option>Autom√°tico</option>
                        <option>Jo√£o Silva</option>
                        <option>Maria Oliveira</option>
                    </select>
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('newWaveModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="createWave()">Criar Onda</button>
            </div>
        </div>
    </div>

    <!-- Out of Stock Modal -->
    <div id="outOfStockModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">‚ö†Ô∏è Produto Sem Estoque</h2>
                <button class="close-modal" onclick="closeModal('outOfStockModal')">√ó</button>
            </div>

            <div class="alert alert-danger">
                <span style="font-size: 1.5rem;">‚ö†Ô∏è</span>
                <div>
                    <strong>Produto n√£o encontrado no estoque</strong>
                </div>
            </div>

            <div style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">Produto:</div>
                <div>Camiseta Premium - Azul M</div>
                <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">SKU: CAM-PREM-AZL-M</div>
                <div style="font-size: 0.875rem; color: var(--gray-600);">Quantidade necess√°ria: 2 unidades</div>
                <div style="font-size: 0.875rem; color: var(--danger); font-weight: 600; margin-top: 0.5rem;">Estoque atual: 0 unidades</div>
            </div>

            <div class="form-group">
                <label>A√ß√£o</label>
                <select id="outOfStockAction">
                    <option value="purchase_order">Criar Ordem de Compra Autom√°tica</option>
                    <option value="alert">Apenas Criar Alerta</option>
                    <option value="skip">Pular Item e Continuar</option>
                </select>
            </div>

            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea rows="3" placeholder="Adicione observa√ß√µes sobre o problema..."></textarea>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('outOfStockModal')">Cancelar</button>
                <button class="btn btn-warning" onclick="handleOutOfStock()">Confirmar A√ß√£o</button>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Novo Produto</h2>
                <button class="close-modal" onclick="closeModal('addProductModal')">√ó</button>
            </div>

            <div class="grid grid-2">
                <div class="form-group">
                    <label>SKU *</label>
                    <input type="text" placeholder="Ex: CAM-PREM-AZL-M" required>
                </div>
                <div class="form-group">
                    <label>Nome do Produto *</label>
                    <input type="text" placeholder="Ex: Camiseta Premium Azul M" required>
                </div>
            </div>

            <div class="form-group">
                <label>Descri√ß√£o</label>
                <textarea rows="2" placeholder="Descri√ß√£o detalhada do produto..."></textarea>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <div>
                        <h3 style="font-size: 0.938rem; font-weight: 600; margin: 0; margin-bottom: 0.25rem;">üìä C√≥digos de Barras</h3>
                        <p style="font-size: 0.75rem; color: var(--gray-600); margin: 0;">
                            Configure os c√≥digos EAN/DUN para identifica√ß√£o do produto
                        </p>
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="addBarcodeField()" type="button">
                        ‚ûï Adicionar C√≥digo
                    </button>
                </div>
                
                <div id="barcodeFields">
                    <div class="barcode-item" style="border: 1px solid var(--gray-300); background: white; padding: 1rem; border-radius: 0.75rem; margin-bottom: 1rem;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div style="width: 36px; height: 36px; background: #ede9fe; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; font-size: 1.125rem;">
                                üìä
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: var(--gray-700); font-size: 0.875rem;">
                                    C√≥digo Principal
                                </div>
                                <div style="font-size: 0.75rem; color: var(--gray-600);">
                                    C√≥digo de barras principal do produto
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-2" style="gap: 0.75rem;">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Tipo *</label>
                                <select class="barcode-type-select" style="border: 1px solid var(--gray-300); font-weight: 500;">
                                    <option value="ean13">EAN-13 (13 d√≠gitos)</option>
                                    <option value="dun14">DUN-14 (14 d√≠gitos)</option>
                                    <option value="ean8">EAN-8 (8 d√≠gitos)</option>
                                    <option value="upc">UPC-A (12 d√≠gitos)</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">C√≥digo *</label>
                                <div style="display: flex; gap: 0.5rem;">
                                    <input type="text" class="barcode-input" placeholder="Ex: 7891234567890" maxlength="14" style="flex: 1; border: 1px solid var(--gray-300); font-weight: 500; font-family: 'Courier New', monospace;">
                                    <button class="btn btn-outline btn-sm remove-barcode-btn" onclick="removeBarcodeField(this)" type="button" style="background: var(--gray-50); border-color: var(--gray-300); display: none;">
                                        üóëÔ∏è
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="background: #dbeafe; border: 1px solid #93c5fd; padding: 0.875rem 1rem; border-radius: 0.5rem; display: flex; gap: 0.75rem; align-items: start;">
                    <div style="font-size: 1.25rem; line-height: 1;">‚ÑπÔ∏è</div>
                    <div style="flex: 1;">
                        <div style="font-size: 0.813rem; color: #1e40af; line-height: 1.5;">
                            <strong>Dica:</strong> Voc√™ pode adicionar m√∫ltiplos c√≥digos de barras para o mesmo produto (embalagem individual, caixa, display, etc).
                        </div>
                    </div>
                </div>
            </div>

            <!-- Estoque Global -->
            <div style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                <h3 style="font-size: 0.938rem; font-weight: 600; margin-bottom: 1rem;">üìä Controle Global de Estoque</h3>
                <div class="grid grid-2">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label>Estoque M√≠nimo (Alerta) *</label>
                        <input type="number" id="globalMinStock" value="50" placeholder="50">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label>Estoque M√°ximo *</label>
                        <input type="number" id="globalMaxStock" value="500" placeholder="500">
                    </div>
                </div>
                <p style="font-size: 0.75rem; color: var(--gray-600); margin-top: 0.5rem;">
                    üí° Estes valores controlam alertas e limites gerais do produto
                </p>
            </div>

            <!-- Localiza√ß√µes -->
            <div style="margin-bottom: 1.5rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <div>
                        <h3 style="font-size: 0.938rem; font-weight: 600; margin: 0; margin-bottom: 0.25rem;">üìç Localiza√ß√µes</h3>
                        <p style="font-size: 0.75rem; color: var(--gray-600); margin: 0;">
                            Configure as posi√ß√µes de armazenamento (obrigat√≥rio pelo menos 1 posi√ß√£o ESTOQUE)
                        </p>
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="addPositionField()" type="button">
                        ‚ûï Adicionar Posi√ß√£o
                    </button>
                </div>
                
                <div id="positionFields">
                    <!-- Posi√ß√£o inicial de ESTOQUE (obrigat√≥ria) -->
                    <div class="position-item" data-position-type="estoque" style="border: 1px solid var(--gray-300); background: white; padding: 1.25rem; border-radius: 0.75rem; margin-bottom: 1rem; transition: all 0.3s;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div class="position-icon" style="width: 36px; height: 36px; background: #dcfce7; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; font-size: 1.125rem;">
                                    üè™
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--gray-700); font-size: 0.938rem;">
                                        Posi√ß√£o <span class="position-number">1</span>
                                    </div>
                                    <div class="position-type-label" style="font-size: 0.75rem; color: #059669; font-weight: 500;">
                                        ESTOQUE (Obrigat√≥rio)
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-outline btn-sm remove-position-btn" onclick="removePositionField(this)" type="button" style="background: var(--gray-50); border-color: var(--gray-300); display: none;">
                                üóëÔ∏è Remover
                            </button>
                        </div>
                        
                        <div class="grid grid-2" style="gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Tipo da Posi√ß√£o *</label>
                                <select class="position-type-select" onchange="updatePositionOptions(this)" style="border: 1px solid var(--gray-300); font-weight: 500;">
                                    <option value="estoque">üè™ ESTOQUE (Origem para Abastecimento)</option>
                                    <option value="pulmao">üì¶ PULM√ÉO (Reserva R√°pida)</option>
                                    <option value="picking">üéØ PICKING (Separa√ß√£o Ativa)</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Posi√ß√£o F√≠sica *</label>
                                <select class="position-location-select" style="border: 1px solid var(--gray-300); font-weight: 500;">
                                    <option value="">Selecione uma posi√ß√£o</option>
                                    <!-- Op√ß√µes ser√£o preenchidas via JS baseado no tipo -->
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-3" style="gap: 0.75rem;">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Qtd. Inicial</label>
                                <input type="number" class="position-qty" value="0" placeholder="0" min="0" style="border: 1px solid var(--gray-300); font-weight: 500;">
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Estoque M√≠n.</label>
                                <input type="number" class="position-min" value="10" placeholder="10" min="0" style="border: 1px solid var(--gray-300); font-weight: 500;">
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Estoque M√°x.</label>
                                <input type="number" class="position-max" value="100" placeholder="100" min="0" style="border: 1px solid var(--gray-300); font-weight: 500;">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Info Box -->
                <div style="background: #fef3c7; border: 1px solid #fde68a; padding: 0.875rem 1rem; border-radius: 0.5rem; display: flex; gap: 0.75rem; align-items: start;">
                    <div style="font-size: 1.25rem; line-height: 1;">‚ö†Ô∏è</div>
                    <div style="flex: 1;">
                        <div style="font-size: 0.813rem; color: #92400e; line-height: 1.5;">
                            <strong>Importante:</strong> √â obrigat√≥rio ter pelo menos uma posi√ß√£o do tipo <strong>ESTOQUE</strong>. 
                            Posi√ß√µes ESTOQUE servem como origem para abastecer PULM√ÉO e PICKING.
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-2">
                <div class="form-group">
                    <label>Pre√ßo de Custo</label>
                    <input type="number" step="0.01" placeholder="0.00">
                </div>
                <div class="form-group">
                    <label>Pre√ßo de Venda</label>
                    <input type="number" step="0.01" placeholder="0.00">
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('addProductModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveProduct()">Salvar Produto</button>
            </div>
        </div>
    </div>

    <!-- Manual Order Modal -->
    <div id="manualOrderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Pedido Manual</h2>
                <button class="close-modal" onclick="closeModal('manualOrderModal')">√ó</button>
            </div>

            <div class="grid grid-2">
                <div class="form-group">
                    <label>ID do Pedido</label>
                    <input type="text" placeholder="Ex: #MANUAL-001">
                </div>
                <div class="form-group">
                    <label>Plataforma</label>
                    <select>
                        <option>Manual</option>
                        <option>Mercado Livre</option>
                        <option>Shopee</option>
                        <option>Amazon</option>
                        <option>Magazine Luiza</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>Nome do Cliente</label>
                <input type="text" placeholder="Ex: Jo√£o da Silva">
            </div>

            <div class="form-group">
                <label>Produtos</label>
                <div id="manualOrderProducts">
                    <div class="grid grid-3" style="margin-bottom: 0.5rem;">
                        <select style="grid-column: span 2;">
                            <option>Selecione um produto</option>
                            <option>Camiseta Premium Azul M</option>
                            <option>T√™nis Esportivo Preto 42</option>
                            <option>Mochila Notebook 15"</option>
                        </select>
                        <input type="number" placeholder="Qtd" value="1">
                    </div>
                </div>
                <button class="btn btn-outline btn-sm" onclick="addProductToManualOrder()">‚ûï Adicionar Produto</button>
            </div>

            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea rows="3" placeholder="Adicione observa√ß√µes sobre o pedido..."></textarea>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('manualOrderModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveManualOrder()">Criar Pedido</button>
            </div>
        </div>
    </div>

    <!-- Import Orders Modal -->
    <div id="importOrdersModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Importar Pedidos CSV</h2>
                <button class="close-modal" onclick="closeModal('importOrdersModal')">√ó</button>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <p style="color: var(--gray-600); margin-bottom: 1rem;">
                    Fa√ßa upload de um arquivo CSV com os pedidos. O arquivo deve conter as colunas: ID, Cliente, Produtos, Quantidade, Valor.
                </p>
                
                <div style="border: 2px dashed var(--gray-300); border-radius: 0.5rem; padding: 2rem; text-align: center; background: var(--gray-50); cursor: pointer;" onclick="document.getElementById('csvFileInput').click()">
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">üìÑ</div>
                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Clique para selecionar arquivo</div>
                    <div style="font-size: 0.875rem; color: var(--gray-600);">ou arraste o arquivo CSV aqui</div>
                    <input type="file" id="csvFileInput" accept=".csv" style="display: none;" onchange="handleCSVUpload(this)">
                </div>
            </div>

            <div id="csvPreview" style="display: none; margin-bottom: 1.5rem;">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">Preview:</div>
                <div style="border: 1px solid var(--gray-300); border-radius: 0.5rem; padding: 1rem; background: white; max-height: 200px; overflow-y: auto;">
                    <div id="csvPreviewContent"></div>
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('importOrdersModal')">Cancelar</button>
                <button class="btn btn-primary" id="importCSVBtn" disabled onclick="importCSV()">Importar Pedidos</button>
            </div>
        </div>
    </div>

    <!-- Add Platform Modal -->
    <div id="addPlatformModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Conectar Nova Plataforma</h2>
                <button class="close-modal" onclick="closeModal('addPlatformModal')">√ó</button>
            </div>

            <div class="form-group">
                <label>Selecione a Plataforma</label>
                <select id="platformSelect">
                    <option value="">Escolha uma plataforma</option>
                    <option value="mercadolivre">Mercado Livre</option>
                    <option value="shopee">Shopee</option>
                    <option value="amazon">Amazon</option>
                    <option value="magalu">Magazine Luiza</option>
                    <option value="americanas">Americanas</option>
                    <option value="casasbahia">Casas Bahia</option>
                    <option value="aliexpress">AliExpress</option>
                    <option value="custom">Outra / Personalizada</option>
                </select>
            </div>

            <div id="customPlatformName" style="display: none;">
                <div class="form-group">
                    <label>Nome da Plataforma</label>
                    <input type="text" placeholder="Ex: Minha Loja">
                </div>
            </div>

            <div class="form-group">
                <label>API Key / Token de Acesso</label>
                <input type="text" placeholder="Cole o token de acesso da plataforma">
            </div>

            <div class="form-group">
                <label>ID da Loja / Seller ID</label>
                <input type="text" placeholder="Ex: 123456789">
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                    Sincronizar pedidos automaticamente
                </label>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                    Atualizar estoque automaticamente
                </label>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('addPlatformModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="connectPlatform()">Conectar Plataforma</button>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div id="orderDetailsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title">Detalhes do Pedido #SH-78234</h2>
                <button class="close-modal" onclick="closeModal('orderDetailsModal')">√ó</button>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <div class="grid grid-2" style="margin-bottom: 1rem;">
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Cliente</div>
                        <div style="font-weight: 600;">Carlos Lima</div>
                    </div>
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Status</div>
                        <span class="badge badge-info">Em Separa√ß√£o</span>
                    </div>
                </div>
                <div class="grid grid-2" style="margin-bottom: 1rem;">
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Data do Pedido</div>
                        <div>10/02/2026 13:15</div>
                    </div>
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Total</div>
                        <div style="font-weight: 600; color: var(--success);">R$ 89,90</div>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <h3 style="font-weight: 600; margin-bottom: 0.75rem;">Produtos</h3>
                <div style="border: 1px solid var(--gray-200); border-radius: 0.5rem; padding: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <div>
                            <div style="font-weight: 600;">T√™nis Esportivo Preto 42</div>
                            <div style="font-size: 0.875rem; color: var(--gray-600);">SKU: TEN-ESP-PRT-42</div>
                        </div>
                        <div style="text-align: right;">
                            <div>1x</div>
                            <div style="font-weight: 600;">R$ 89,90</div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <h3 style="font-weight: 600; margin-bottom: 0.75rem;">Endere√ßo de Entrega</h3>
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem;">
                    <div>Rua das Palmeiras, 456</div>
                    <div>Bairro Centro - S√£o Paulo, SP</div>
                    <div>CEP: 01234-567</div>
                </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <h3 style="font-weight: 600; margin-bottom: 0.75rem;">Hist√≥rico</h3>
                <div style="border-left: 2px solid var(--gray-300); padding-left: 1rem;">
                    <div style="margin-bottom: 0.75rem;">
                        <div style="font-weight: 600; font-size: 0.875rem;">Separa√ß√£o Iniciada</div>
                        <div style="font-size: 0.813rem; color: var(--gray-600);">10/02/2026 13:45 - Jo√£o Silva</div>
                    </div>
                    <div>
                        <div style="font-weight: 600; font-size: 0.875rem;">Pedido Recebido</div>
                        <div style="font-size: 0.813rem; color: var(--gray-600);">10/02/2026 13:15</div>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('orderDetailsModal')">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Edit PO Modal -->
    <div id="editPOModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Editar Ordem de Compra</h2>
                <button class="close-modal" onclick="closeModal('editPOModal')">√ó</button>
            </div>

            <div class="form-group">
                <label>Produto</label>
                <input type="text" value="Mochila Notebook 15&quot;" readonly style="background: var(--gray-50);">
            </div>

            <div class="grid grid-2">
                <div class="form-group">
                    <label>Fornecedor</label>
                    <select>
                        <option selected>Fornecedor ABC</option>
                        <option>Tech Imports</option>
                        <option>Eletr√¥nicos XYZ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Quantidade</label>
                    <input type="number" value="50">
                </div>
            </div>

            <div class="grid grid-2">
                <div class="form-group">
                    <label>Pre√ßo Unit√°rio</label>
                    <input type="number" step="0.01" value="37.50">
                </div>
                <div class="form-group">
                    <label>Total</label>
                    <input type="text" value="R$ 1.875,00" readonly style="background: var(--gray-50); font-weight: 600;">
                </div>
            </div>

            <div class="form-group">
                <label>Data de Entrega Prevista</label>
                <input type="date" value="2026-02-20">
            </div>

            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea rows="3" placeholder="Adicione observa√ß√µes..."></textarea>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('editPOModal')">Cancelar</button>
                <button class="btn btn-success" onclick="approvePO()">‚úÖ Aprovar e Enviar</button>
            </div>
        </div>
    </div>

    <!-- PO Details Modal -->
    <div id="poDetailsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title">Detalhes da Ordem PO-2024-001</h2>
                <button class="close-modal" onclick="closeModal('poDetailsModal')">√ó</button>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <div class="grid grid-2" style="margin-bottom: 1rem;">
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Fornecedor</div>
                        <div style="font-weight: 600;">Fornecedor ABC</div>
                    </div>
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Status</div>
                        <span class="badge badge-info">Em Tr√¢nsito</span>
                    </div>
                </div>
                <div class="grid grid-2">
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Data da Ordem</div>
                        <div>05/02/2026</div>
                    </div>
                    <div>
                        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Entrega Prevista</div>
                        <div style="font-weight: 600;">15/02/2026</div>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <h3 style="font-weight: 600; margin-bottom: 0.75rem;">Produtos (3 itens)</h3>
                <div style="border: 1px solid var(--gray-200); border-radius: 0.5rem; padding: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.75rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--gray-200);">
                        <div>
                            <div style="font-weight: 600;">Mochila Notebook 15"</div>
                            <div style="font-size: 0.875rem; color: var(--gray-600);">50 unidades √ó R$ 37,50</div>
                        </div>
                        <div style="font-weight: 600;">R$ 1.875,00</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.75rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--gray-200);">
                        <div>
                            <div style="font-weight: 600;">Teclado Mec√¢nico</div>
                            <div style="font-size: 0.875rem; color: var(--gray-600);">60 unidades √ó R$ 75,00</div>
                        </div>
                        <div style="font-weight: 600;">R$ 4.500,00</div>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <div style="font-weight: 600;">Mouse Sem Fio</div>
                            <div style="font-size: 0.875rem; color: var(--gray-600);">40 unidades √ó R$ 52,00</div>
                        </div>
                        <div style="font-weight: 600;">R$ 2.080,00</div>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 1rem; padding-top: 1rem; border-top: 2px solid var(--gray-300);">
                    <strong>Total da Ordem:</strong>
                    <strong style="font-size: 1.25rem; color: var(--success);">R$ 8.455,00</strong>
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('poDetailsModal')">Fechar</button>
                <button class="btn btn-primary">üìß Enviar Email</button>
            </div>
        </div>
    </div>

    <!-- Platform Config Modal -->
    <div id="platformConfigModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Configura√ß√µes da Plataforma</h2>
                <button class="close-modal" onclick="closeModal('platformConfigModal')">√ó</button>
            </div>

            <div class="form-group">
                <label>Nome da Plataforma</label>
                <input type="text" value="Mercado Livre" readonly style="background: var(--gray-50);">
            </div>

            <div class="form-group">
                <label>API Key / Token de Acesso</label>
                <input type="text" value="APP-123456789-020226-‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" placeholder="Cole o token de acesso">
            </div>

            <div class="form-group">
                <label>ID da Loja / Seller ID</label>
                <input type="text" value="123456789" placeholder="Ex: 123456789">
            </div>

            <div class="form-group">
                <label>Intervalo de Sincroniza√ß√£o (minutos)</label>
                <input type="number" value="5" min="1">
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                    Sincronizar pedidos automaticamente
                </label>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" checked style="width: auto; margin-right: 0.5rem;">
                    Atualizar estoque automaticamente
                </label>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" style="width: auto; margin-right: 0.5rem;">
                    Enviar notifica√ß√µes de novos pedidos
                </label>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: space-between; margin-top: 2rem;">
                <button class="btn btn-outline" style="background: var(--danger); color: white; border-color: var(--danger);">
                    üóëÔ∏è Desconectar Plataforma
                </button>
                <div style="display: flex; gap: 0.75rem;">
                    <button class="btn btn-outline" onclick="closeModal('platformConfigModal')">Cancelar</button>
                    <button class="btn btn-primary" onclick="savePlatformConfig()">Salvar Configura√ß√µes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Replenishment Modal -->
    <div id="replenishmentModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 0.75rem 0.75rem 0 0; margin: -1.5rem -1.5rem 1.5rem -1.5rem; padding: 1.5rem;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 56px; height: 56px; background: rgba(255,255,255,0.2); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 2rem; backdrop-filter: blur(10px);">
                        üîÑ
                    </div>
                    <div style="flex: 1;">
                        <h2 class="modal-title" style="margin: 0; font-size: 1.5rem; color: white;">Abastecimento de Localiza√ß√µes</h2>
                        <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem; color: rgba(255,255,255,0.9);">Transfira produtos entre posi√ß√µes do armaz√©m</p>
                    </div>
                </div>
                <button class="close-modal" onclick="closeModal('replenishmentModal')" style="color: white; opacity: 0.9;">√ó</button>
            </div>

            <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 1.5rem; border-radius: 1rem; margin-bottom: 1.5rem; border: 2px solid #0ea5e9; position: relative; overflow: hidden;">
                <div style="position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; background: rgba(14, 165, 233, 0.1); border-radius: 50%;"></div>
                <div style="position: relative;">
                    <div style="font-weight: 600; margin-bottom: 0.75rem; color: #0369a1; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.5rem;">üí°</span>
                        <span>Hierarquia de Abastecimento</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1rem; background: white; border-radius: 0.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <span style="font-size: 1.5rem;">üè™</span>
                            <span style="font-weight: 600; color: #059669;">ESTOQUE</span>
                        </div>
                        <div style="color: #0284c7; font-size: 1.25rem; font-weight: bold;">‚Üí</div>
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <div style="padding: 0.75rem 1rem; background: white; border-radius: 0.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                                <span style="font-size: 1.5rem;">üì¶</span>
                                <span style="font-weight: 600; color: #d97706; margin-left: 0.5rem;">PULM√ÉO</span>
                            </div>
                            <div style="padding: 0.75rem 1rem; background: white; border-radius: 0.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                                <span style="font-size: 1.5rem;">üéØ</span>
                                <span style="font-weight: 600; color: #0284c7; margin-left: 0.5rem;">PICKING</span>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 0.75rem; display: flex; align-items: center; gap: 0.5rem; padding-left: 1rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span style="font-size: 1.25rem;">üì¶</span>
                            <span style="font-weight: 600; color: #d97706;">PULM√ÉO</span>
                        </div>
                        <div style="color: #0284c7; font-size: 1.25rem; font-weight: bold;">‚Üí</div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span style="font-size: 1.25rem;">üéØ</span>
                            <span style="font-weight: 600; color: #0284c7;">PICKING</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Produto</label>
                <div style="display: flex; gap: 0.5rem;">
                    <input 
                        type="text" 
                        id="replenishProductSelect" 
                        list="productDatalist" 
                        placeholder="Digite ou selecione um produto..."
                        oninput="loadProductReplenishmentInfo()"
                        style="flex: 1; font-weight: 500;"
                    >
                    <datalist id="productDatalist">
                        <option value="CAM-PREM-AZL-M">Camiseta Premium Azul M</option>
                        <option value="TEN-ESP-PRT-42">T√™nis Esportivo Preto 42</option>
                        <option value="MOCH-NOTE-15">Mochila Notebook 15"</option>
                        <option value="REL-SMART-PRT">Rel√≥gio Smartwatch Preto</option>
                    </datalist>
                    <button 
                        class="btn btn-primary" 
                        onclick="openScannerModal('product')" 
                        type="button"
                        style="padding: 0.75rem 1rem; white-space: nowrap; display: flex; align-items: center; gap: 0.5rem;"
                        title="Bipar c√≥digo de barras"
                    >
                        <span style="font-size: 1.25rem;">üì∑</span>
                        <span style="font-size: 0.875rem;">Bipar</span>
                    </button>
                </div>
            </div>

            <div id="replenishmentInfo" style="display: none;">
                <!-- Sele√ß√£o de Origem -->
                <div class="form-group">
                    <label>Posi√ß√£o de Origem</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input 
                            type="text" 
                            id="replenishOriginSelect" 
                            list="originDatalist" 
                            placeholder="Digite ou selecione a posi√ß√£o de origem..."
                            oninput="updateReplenishmentDestinations()"
                            style="flex: 1; font-weight: 500; text-transform: uppercase;"
                        >
                        <datalist id="originDatalist">
                            <!-- Ser√° preenchido dinamicamente -->
                        </datalist>
                        <button 
                            class="btn btn-primary" 
                            onclick="openScannerModal('origin')" 
                            type="button"
                            style="padding: 0.75rem 1rem; white-space: nowrap; display: flex; align-items: center; gap: 0.5rem;"
                            title="Bipar posi√ß√£o"
                        >
                            <span style="font-size: 1.25rem;">üì∑</span>
                            <span style="font-size: 0.875rem;">Bipar</span>
                        </button>
                    </div>
                </div>

                <!-- Info da Origem -->
                <div id="originInfo" style="background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%); padding: 1.5rem; border-radius: 1rem; margin-bottom: 1.5rem; display: none; border: 2px solid #10b981; position: relative; overflow: hidden; box-shadow: 0 4px 6px rgba(16, 185, 129, 0.1);">
                    <div style="position: absolute; top: 0; right: 0; width: 150px; height: 150px; background: rgba(255,255,255,0.3); border-radius: 0 1rem 0 100%; "></div>
                    <div style="position: relative;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                            <div id="originIconBox" style="width: 48px; height: 48px; background: white; border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <span id="originIcon"></span>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 0.75rem; font-weight: 500; color: #065f46; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem;">
                                    üìç Origem ‚Ä¢ <span id="originTypeLabel"></span>
                                </div>
                                <div style="font-weight: 700; color: #047857; font-size: 1.125rem;" id="originPositionName">
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 0.75rem; color: #065f46; font-weight: 500; margin-bottom: 0.25rem;">DISPON√çVEL</div>
                                <div style="font-size: 2rem; font-weight: 700; color: #047857; line-height: 1;" id="originStock">
                                    120 un.
                                </div>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 0.5rem; padding: 0.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem; color: #065f46; margin-bottom: 0.25rem;">
                                <span>Capacidade utilizada</span>
                                <span id="originCapacityText" style="font-weight: 600;">-</span>
                            </div>
                            <div style="height: 8px; background: #e5e7eb; border-radius: 1rem; overflow: hidden;">
                                <div id="originProgressBar" style="height: 100%; background: linear-gradient(90deg, #10b981 0%, #059669 100%); width: 0%; transition: width 0.5s ease;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visualiza√ß√£o de Fluxo -->
                <div id="flowVisualization" style="display: none; margin: 1.5rem 0; text-align: center;">
                    <div style="display: inline-flex; align-items: center; gap: 1rem; padding: 1.5rem; background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border-radius: 1rem; border: 2px dashed #a855f7;">
                        <div style="text-align: center;">
                            <div style="font-size: 0.75rem; color: #7e22ce; font-weight: 600; margin-bottom: 0.5rem;">DE</div>
                            <div id="flowOriginBox" style="padding: 1rem 1.5rem; background: white; border-radius: 0.75rem; box-shadow: 0 4px 6px rgba(168, 85, 247, 0.15); font-weight: 600; color: #7e22ce;">
                                <span id="flowOriginIcon" style="font-size: 1.5rem;"></span>
                                <div id="flowOriginName" style="margin-top: 0.5rem; font-size: 0.875rem;"></div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <div style="width: 60px; height: 3px; background: linear-gradient(90deg, #a855f7 0%, #7e22ce 100%);"></div>
                            <div style="font-size: 2rem; animation: pulse 2s ease-in-out infinite;">üì¶</div>
                            <div style="width: 60px; height: 3px; background: linear-gradient(90deg, #7e22ce 0%, #6b21a8 100%);"></div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.75rem; color: #7e22ce; font-weight: 600; margin-bottom: 0.5rem;">PARA</div>
                            <div id="flowDestBox" style="padding: 1rem 1.5rem; background: white; border-radius: 0.75rem; box-shadow: 0 4px 6px rgba(168, 85, 247, 0.15); font-weight: 600; color: #7e22ce;">
                                <span id="flowDestIcon" style="font-size: 1.5rem;"></span>
                                <div id="flowDestName" style="margin-top: 0.5rem; font-size: 0.875rem;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sele√ß√£o de Destino -->
                <div class="form-group">
                    <label>Posi√ß√£o de Destino</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input 
                            type="text" 
                            id="replenishDestinationSelect" 
                            list="destinationDatalist" 
                            placeholder="Digite ou selecione a posi√ß√£o de destino..."
                            oninput="updateReplenishmentForm()"
                            disabled
                            style="flex: 1; font-weight: 500; text-transform: uppercase;"
                        >
                        <datalist id="destinationDatalist">
                            <!-- Ser√° preenchido dinamicamente baseado na origem -->
                        </datalist>
                        <button 
                            class="btn btn-primary" 
                            id="destinationScanBtn"
                            onclick="openScannerModal('destination')" 
                            type="button"
                            disabled
                            style="padding: 0.75rem 1rem; white-space: nowrap; display: flex; align-items: center; gap: 0.5rem;"
                            title="Bipar posi√ß√£o"
                        >
                            <span style="font-size: 1.25rem;">üì∑</span>
                            <span style="font-size: 0.875rem;">Bipar</span>
                        </button>
                    </div>
                </div>

                <!-- Formul√°rio de Abastecimento -->
                <div id="replenishmentForm" style="display: none; margin-bottom: 1.5rem;">
                    <!-- Card de Destino -->
                    <div style="background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%); border: 2px solid #f97316; border-radius: 1rem; padding: 1.5rem; margin-bottom: 1.5rem; position: relative; overflow: hidden; box-shadow: 0 4px 6px rgba(249, 115, 22, 0.1);">
                        <div style="position: absolute; top: -30px; right: -30px; width: 120px; height: 120px; background: rgba(255,255,255,0.3); border-radius: 50%;"></div>
                        <div style="position: relative;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1.25rem;">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <div style="width: 48px; height: 48px; background: white; border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <span id="destIcon"></span>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.75rem; font-weight: 500; color: #9a3412; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem;">
                                            üéØ Destino
                                        </div>
                                        <div style="font-weight: 700; color: #7c2d12; font-size: 1.125rem;" id="destPositionName"></div>
                                    </div>
                                </div>
                                <div class="badge badge-info" id="destStatus"></div>
                            </div>
                            
                            <!-- Indicadores Visuais -->
                            <div style="background: white; border-radius: 0.75rem; padding: 1rem; margin-bottom: 1rem;">
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; text-align: center;">
                                    <div>
                                        <div style="font-size: 0.75rem; color: #9a3412; font-weight: 500; margin-bottom: 0.25rem;">ATUAL</div>
                                        <div style="font-size: 1.5rem; font-weight: 700; color: #ea580c;" id="destCurrent">-</div>
                                    </div>
                                    <div style="border-left: 2px solid #fed7aa; border-right: 2px solid #fed7aa;">
                                        <div style="font-size: 0.75rem; color: #9a3412; font-weight: 500; margin-bottom: 0.25rem;">M√çNIMO</div>
                                        <div style="font-size: 1.5rem; font-weight: 700; color: #c2410c;" id="destMin">-</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.75rem; color: #9a3412; font-weight: 500; margin-bottom: 0.25rem;">M√ÅXIMO</div>
                                        <div style="font-size: 1.5rem; font-weight: 700; color: #7c2d12;" id="destMax">-</div>
                                    </div>
                                </div>
                                <div style="margin-top: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem; color: #9a3412; margin-bottom: 0.25rem;">
                                        <span>Ocupa√ß√£o</span>
                                        <span id="destCapacityText" style="font-weight: 600;">-</span>
                                    </div>
                                    <div style="height: 10px; background: #e5e7eb; border-radius: 1rem; overflow: hidden;">
                                        <div id="destProgressBar" style="height: 100%; background: linear-gradient(90deg, #f97316 0%, #ea580c 100%); width: 0%; transition: width 0.5s ease;"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Inputs de Transfer√™ncia -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label style="font-size: 0.875rem; font-weight: 600; color: #7c2d12; margin-bottom: 0.5rem; display: block;">
                                        üì• Quantidade a Transferir
                                    </label>
                                    <div style="position: relative;">
                                        <input type="number" id="replenishQuantity" value="0" min="0" placeholder="0" 
                                            style="width: 100%; padding: 1rem; font-weight: 700; font-size: 1.5rem; border: 2px solid #f97316; border-radius: 0.75rem; text-align: center; background: white;" 
                                            oninput="updateReplenishmentSummary()">
                                        <div style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); font-size: 0.875rem; color: #9a3412; font-weight: 600;">un.</div>
                                    </div>
                                </div>
                                <div>
                                    <label style="font-size: 0.875rem; font-weight: 600; color: #7c2d12; margin-bottom: 0.5rem; display: block;">
                                        üìä Saldo Final (Destino)
                                    </label>
                                    <div style="position: relative;">
                                        <input type="number" id="finalBalance" readonly 
                                            style="width: 100%; padding: 1rem; font-weight: 700; font-size: 1.5rem; border: 2px solid #fdba74; border-radius: 0.75rem; text-align: center; background: #fffbeb; color: #9a3412;">
                                        <div style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); font-size: 0.875rem; color: #9a3412; font-weight: 600;">un.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sugest√£o -->
                    <div id="suggestionBox" style="margin-bottom: 1.5rem; padding: 1.25rem; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b; border-radius: 1rem; font-size: 0.875rem; color: #92400e; display: none; box-shadow: 0 4px 6px rgba(245, 158, 11, 0.1);">
                        <div style="display: flex; align-items: start; gap: 1rem;">
                            <div style="font-size: 2rem; line-height: 1;">üí°</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 700; margin-bottom: 0.5rem; font-size: 1rem;">Sugest√£o Inteligente</div>
                                <div id="suggestionText" style="line-height: 1.6;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resumo -->
                <div id="replenishmentSummary" style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); padding: 1.5rem; border-radius: 1rem; margin-bottom: 1.5rem; display: none; border: 2px solid #10b981; box-shadow: 0 4px 6px rgba(16, 185, 129, 0.1);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="width: 40px; height: 40px; background: white; border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            üìä
                        </div>
                        <div style="font-weight: 700; color: #065f46; font-size: 1.125rem;">
                            Resumo da Transfer√™ncia
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                        <div style="background: white; padding: 1.25rem; border-radius: 0.75rem; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="font-size: 0.75rem; color: #065f46; font-weight: 600; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.5px;">‚úÖ Quantidade a Transferir</div>
                            <div style="font-size: 2.5rem; font-weight: 700; color: #10b981; line-height: 1;" id="summaryQuantity">0 un.</div>
                        </div>
                        <div style="background: white; padding: 1.25rem; border-radius: 0.75rem; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="font-size: 0.75rem; color: #065f46; font-weight: 600; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.5px;">üì¶ Saldo Restante (Origem)</div>
                            <div style="font-size: 2.5rem; font-weight: 700; color: #059669; line-height: 1;" id="summaryOriginRemaining">- un.</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <textarea rows="2" placeholder="Adicione observa√ß√µes sobre o abastecimento..."></textarea>
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('replenishmentModal')">Cancelar</button>
                <button class="btn btn-primary" id="confirmReplenishmentBtn" disabled onclick="confirmReplenishment()">
                    ‚úÖ Confirmar Abastecimento
                </button>
            </div>
        </div>
    </div>

    <!-- Add Posto Modal -->
    <div id="addPostoModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">Posto</h2>
                <button class="close-modal" onclick="closeModal('addPostoModal')">√ó</button>
            </div>

            <input type="hidden" id="postoEditMode" value="false">

            <!-- Nome do Posto -->
            <div class="form-group">
                <label style="font-weight: 600;">C√≥digo do Posto</label>
                <input type="text" id="postoCode" placeholder="Ex: A, B, C, D..." maxlength="3" style="text-transform: uppercase; font-weight: 600;" oninput="updatePostoPreview()">
                <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">Use letras ou combina√ß√µes (A, B, AA, AB...)</div>
            </div>

            <!-- Tipo do Posto -->
            <div class="form-group">
                <label style="font-weight: 600;">Tipo do Posto</label>
                <select id="postoTypeSelect" style="font-weight: 600;" onchange="updatePostoPreview()">
                    <option value="estoque">üè™ Estoque - Armazenamento principal</option>
                    <option value="pulmao">üì¶ Pulm√£o - Reserva e reabastecimento</option>
                    <option value="picking">üéØ Picking - Separa√ß√£o de pedidos</option>
                    <option value="recebimento">üì• Recebimento - Entrada de mercadorias</option>
                    <option value="expedicao">üì§ Expedi√ß√£o - Sa√≠da de pedidos</option>
                    <option value="devolucao">‚Ü©Ô∏è Devolu√ß√£o - Produtos devolvidos</option>
                    <option value="quarentena">‚ö†Ô∏è Quarentena - Produtos em an√°lise</option>
                    <option value="avariado">üîß Avariado - Produtos danificados</option>
                    <option value="cross_docking">üîÑ Cross Docking - Transfer√™ncia direta</option>
                    <option value="embalagem">üì¶ Embalagem - √Årea de packing</option>
                </select>
            </div>

            <!-- Sequ√™ncia do Posto -->
            <div class="form-group">
                <label style="font-weight: 600; font-size: 1rem; margin-bottom: 0.5rem; display: block;">üî¢ Sequ√™ncia do Posto</label>
                <input type="number" id="postoSequence" value="1" min="1" max="999" placeholder="Ordem de organiza√ß√£o" style="font-weight: 600; font-size: 1.125rem;" oninput="updatePostoPreview()">
                <div style="font-size: 0.75rem; color: var(--gray-600); margin-top: 0.25rem;">üí° Define a ordem de exibi√ß√£o e organiza√ß√£o no armaz√©m (1, 2, 3...)</div>
            </div>

            <!-- Supostos (M√∫ltiplos) -->
            <div class="form-group">
                <label style="font-weight: 600; font-size: 1rem; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: center;">
                    <span>üìö Supostos (Prateleiras)</span>
                    <button type="button" class="btn btn-primary btn-sm" onclick="addPostoSupostoField()" style="font-size: 0.813rem;">‚ûï Adicionar Suposto</button>
                </label>
                <div id="postoSupostosContainer">
                    <div class="posto-suposto-item" style="background: var(--gray-50); padding: 1rem; border-radius: 0.75rem; margin-bottom: 0.75rem; border: 2px solid var(--gray-300);">
                        <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.75rem; align-items: center;">
                            <div>
                                <label style="font-size: 0.75rem; font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem; display: block;">C√≥digo</label>
                                <input type="text" class="suposto-code-input" placeholder="Ex: 01" maxlength="3" style="font-weight: 600; font-size: 1rem;" oninput="updatePostoPreview()">
                            </div>
                            <div>
                                <label style="font-size: 0.75rem; font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem; display: block;">Sequ√™ncia</label>
                                <input type="number" class="suposto-sequence-input" placeholder="1" min="1" max="999" style="font-weight: 600; font-size: 1rem;" oninput="updatePostoPreview()">
                            </div>
                            <button type="button" class="btn btn-outline btn-sm" onclick="removePostoSupostoField(this)" style="margin-top: 1.25rem; display: none;">üóëÔ∏è</button>
                        </div>
                    </div>
                </div>
                <div style="font-size: 0.75rem; color: var(--gray-600); margin-top: 0.25rem;">
                    üí° Cada suposto √© uma prateleira dentro do corredor. C√≥digos n√£o podem repetir.<br>
                    üìä Sequ√™ncia define a ordem das prateleiras (1 = primeira, 2 = segunda...)
                </div>
            </div>

            <!-- Preview -->
            <div style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; border: 1px solid var(--gray-300);">
                <div style="font-weight: 600; margin-bottom: 0.75rem; color: var(--gray-700); font-size: 0.875rem;">Preview</div>
                
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1rem;">
                    <div>
                        <div style="font-size: 0.75rem; color: var(--gray-600); margin-bottom: 0.25rem;">C√ìDIGO</div>
                        <div id="previewPostoCode" style="font-weight: 700; font-size: 1.25rem; color: var(--primary);">-</div>
                    </div>
                    <div>
                        <div style="font-size: 0.75rem; color: var(--gray-600); margin-bottom: 0.25rem;">TIPO</div>
                        <div id="previewPostoType" style="font-weight: 600; font-size: 0.875rem;">-</div>
                    </div>
                    <div>
                        <div style="font-size: 0.75rem; color: var(--gray-600); margin-bottom: 0.25rem;">SEQU√äNCIA</div>
                        <div id="previewPostoSequence" style="font-weight: 600; font-size: 1.25rem;">-</div>
                    </div>
                    <div>
                        <div style="font-size: 0.75rem; color: var(--gray-600); margin-bottom: 0.25rem;">SUPOSTOS</div>
                        <div id="previewSupostoCount" style="font-weight: 600; font-size: 1.25rem;">0</div>
                    </div>
                </div>

                <div style="padding-top: 1rem; border-top: 1px solid var(--gray-300);">
                    <div style="font-size: 0.75rem; font-weight: 600; color: var(--gray-600); margin-bottom: 0.5rem;">Supostos (ordenados)</div>
                    <div id="previewSupostoList" style="font-size: 0.875rem; color: var(--gray-800); line-height: 1.6;">
                        Adicione supostos para visualizar
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('addPostoModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="savePosto()" id="savePostoBtn">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Add Position Modal -->
    <div id="addPositionModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Posi√ß√£o</h2>
                <button class="close-modal" onclick="closeModal('addPositionModal')">√ó</button>
            </div>

            <input type="hidden" id="positionEditMode" value="false">

            <!-- Posto -->
            <div class="form-group">
                <label style="font-weight: 600;">Posto</label>
                <select id="positionPostoSelect" style="font-weight: 600;" onchange="loadSupostosForPosto()">
                    <option value="">Selecione...</option>
                    <option value="A" data-type="estoque">A - Corredor A</option>
                    <option value="B" data-type="picking">B - Corredor B</option>
                    <option value="C" data-type="picking">C - Corredor C</option>
                    <option value="E" data-type="estoque">E - Estoque</option>
                    <option value="P" data-type="pulmao">P - Pulm√£o</option>
                </select>
            </div>

            <!-- Indicador de Tipo do Posto -->
            <div id="postoTypeIndicator" style="display: none; background: var(--gray-50); padding: 0.75rem; border-radius: 0.5rem; margin-bottom: 1rem; border: 1px solid var(--gray-300);">
                <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.25rem;">Tipo do Posto</div>
                <div id="postoTypeValue" style="font-weight: 600; font-size: 1rem;"></div>
            </div>

            <!-- Suposto -->
            <div class="form-group">
                <label style="font-weight: 600;">Suposto</label>
                <select id="positionSupostoSelect" style="font-weight: 600;" disabled onchange="enableAddressField()">
                    <option value="">Selecione o posto primeiro...</option>
                </select>
            </div>

            <!-- Endere√ßo -->
            <div class="form-group">
                <label style="font-weight: 600;">Endere√ßo</label>
                <input type="text" id="positionAddress" placeholder="Digite o endere√ßo" maxlength="50" disabled style="font-weight: 600; text-transform: uppercase;">
                <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">Identifica√ß√£o livre da posi√ß√£o</div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('addPositionModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="savePosition()" id="savePositionBtn">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Import Positions Modal -->
    <div id="importPositionsModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Importar Posi√ß√µes CSV</h2>
                <button class="close-modal" onclick="closeModal('importPositionsModal')">√ó</button>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <p style="color: var(--gray-600); margin-bottom: 1rem;">
                    Fa√ßa upload de um arquivo CSV com as posi√ß√µes. O arquivo deve conter as colunas: Posto, Suposto, Posi√ß√£o, Tipo.
                </p>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Exemplo de CSV:</div>
                    <code style="font-size: 0.813rem;">
                        Posto,Suposto,Posi√ß√£o,Tipo<br>
                        A,01,1,Picking<br>
                        A,01,2,Picking<br>
                        B,05,1,Reserva
                    </code>
                </div>
                
                <div style="border: 2px dashed var(--gray-300); border-radius: 0.5rem; padding: 2rem; text-align: center; background: white; cursor: pointer;" onclick="document.getElementById('positionsCSVInput').click()">
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">üìÑ</div>
                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Clique para selecionar arquivo</div>
                    <div style="font-size: 0.875rem; color: var(--gray-600);">ou arraste o arquivo CSV aqui</div>
                    <input type="file" id="positionsCSVInput" accept=".csv" style="display: none;" onchange="handlePositionsCSVUpload(this)">
                </div>
            </div>

            <div id="positionsCSVPreview" style="display: none; margin-bottom: 1.5rem;">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">Preview:</div>
                <div id="positionsCSVContent" style="border: 1px solid var(--gray-300); border-radius: 0.5rem; padding: 1rem; background: white; max-height: 200px; overflow-y: auto;"></div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('importPositionsModal')">Cancelar</button>
                <button class="btn btn-primary" id="importPositionsBtn" disabled onclick="importPositions()">Importar Posi√ß√µes</button>
            </div>
        </div>
    </div>

    <!-- Add Stock Modal -->
    <div id="addStockModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title" id="stockModalTitle">‚ûï Novo Saldo</h2>
                <button class="close-modal" onclick="closeModal('addStockModal')">√ó</button>
            </div>

            <input type="hidden" id="stockEditMode" value="false">

            <!-- Produto -->
            <div class="form-group">
                <label style="font-weight: 600;">Produto</label>
                <select id="stockProductSelect" required onchange="updateStockPreview()">
                    <option value="">Selecione um produto...</option>
                    <option value="SKU001">SKU001 - Mouse Gamer RGB</option>
                    <option value="SKU002">SKU002 - Teclado Mec√¢nico</option>
                    <option value="SKU003">SKU003 - Monitor 24" Full HD</option>
                </select>
            </div>

            <!-- Posi√ß√£o -->
            <div class="form-group">
                <label style="font-weight: 600;">Posi√ß√£o</label>
                <select id="stockPositionSelect" required onchange="updateStockPreview()">
                    <option value="">Selecione uma posi√ß√£o...</option>
                    <option value="E-01-1" data-type="estoque">E-01-1 (üè™ ESTOQUE)</option>
                    <option value="E-01-2" data-type="estoque">E-01-2 (üè™ ESTOQUE)</option>
                    <option value="E-02-1" data-type="estoque">E-02-1 (üè™ ESTOQUE)</option>
                    <option value="P-01-1" data-type="pulmao">P-01-1 (üì¶ PULM√ÉO)</option>
                    <option value="P-01-2" data-type="pulmao">P-01-2 (üì¶ PULM√ÉO)</option>
                    <option value="PK-01-1" data-type="picking">PK-01-1 (üéØ PICKING)</option>
                    <option value="PK-02-1" data-type="picking">PK-02-1 (üéØ PICKING)</option>
                </select>
            </div>

            <!-- Saldo Inicial -->
            <div class="form-group">
                <label style="font-weight: 600;">Saldo Inicial</label>
                <input type="number" id="stockInitialBalance" placeholder="Quantidade inicial" min="0" required oninput="updateStockPreview()">
            </div>

            <!-- Quantidade M√≠nima e M√°xima -->
            <div class="grid grid-2">
                <div class="form-group">
                    <label style="font-weight: 600;">Quantidade M√≠nima</label>
                    <input type="number" id="stockMinQuantity" placeholder="M√≠nimo" min="0" required oninput="updateStockPreview()">
                    <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">Alerta de reabastecimento</div>
                </div>
                <div class="form-group">
                    <label style="font-weight: 600;">Quantidade M√°xima</label>
                    <input type="number" id="stockMaxQuantity" placeholder="M√°ximo" min="0" required oninput="updateStockPreview()">
                    <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">Capacidade da posi√ß√£o</div>
                </div>
            </div>

            <!-- Preview -->
            <div style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; border: 1px solid var(--gray-300);">
                <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 0.5rem;">üìã Resumo do Registro</div>
                <div id="stockPreview" style="font-size: 0.875rem; color: var(--gray-700);">
                    Preencha os campos para ver o resumo
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('addStockModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveStock()">üíæ Salvar Registro</button>
            </div>
        </div>
    </div>

    <!-- Import Stock Modal -->
    <div id="importStockModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">üìÑ Importar Saldos</h2>
                <button class="close-modal" onclick="closeModal('importStockModal')">√ó</button>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Arquivo CSV</label>
                <input type="file" accept=".csv" onchange="handleStockCSVUpload(this)">
                <div style="margin-top: 0.75rem; padding: 1rem; background: var(--gray-50); border-radius: 0.5rem; font-size: 0.875rem;">
                    <strong>Formato esperado:</strong><br>
                    <code>SKU,Posi√ß√£o,Saldo Inicial,Qtd M√≠nima,Qtd M√°xima</code><br>
                    <br>
                    <strong>Exemplo:</strong><br>
                    <code>SKU001,E-01-1,450,100,1000</code><br>
                    <code>SKU001,P-01-2,18,20,50</code><br>
                    <code>SKU002,E-01-2,280,50,500</code>
                </div>
            </div>

            <div id="stockCSVPreview" style="display: none; margin-bottom: 1.5rem;">
                <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem;">Preview</h3>
                <div id="stockCSVContent" style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem; max-height: 200px; overflow-y: auto;"></div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('importStockModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="importStock()">üì• Importar</button>
            </div>
        </div>
    </div>

    <!-- Restore Stock Modal -->
    <div id="restoreStockModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border-radius: 0.75rem 0.75rem 0 0; margin: -2rem -2rem 1.5rem -2rem; padding: 1.5rem;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 56px; height: 56px; background: rgba(255,255,255,0.2); border-radius: 1rem; display: flex; align-items: center; justify-content: center; font-size: 2rem; backdrop-filter: blur(10px);">
                        üì¶
                    </div>
                    <div style="flex: 1;">
                        <h2 class="modal-title" style="margin: 0; font-size: 1.5rem; color: white;">Restaurar Estoque</h2>
                        <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem; color: rgba(255,255,255,0.9);">Receber produtos de ordens de compra aprovadas e entregues</p>
                    </div>
                </div>
                <button class="close-modal" onclick="closeModal('restoreStockModal')" style="color: white; opacity: 0.9;">√ó</button>
            </div>

            <!-- Informa√ß√µes do Estoque -->
            <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); padding: 1.5rem; border-radius: 1rem; margin-bottom: 1.5rem; border: 2px solid #3b82f6;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 48px; height: 48px; background: white; border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        üè™
                    </div>
                    <div style="flex: 1;">
                        <div style="font-size: 0.75rem; font-weight: 500; color: #1e40af; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem;">
                            POSI√á√ÉO DE ESTOQUE
                        </div>
                        <div style="font-weight: 700; color: #1e3a8a; font-size: 1.125rem;" id="restorePositionName">E-01-1</div>
                        <div style="font-size: 0.875rem; color: #3b82f6; margin-top: 0.25rem;" id="restoreProductName">SKU001 - Mouse Gamer RGB</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 0.75rem; color: #1e40af; font-weight: 500; margin-bottom: 0.25rem;">SALDO ATUAL</div>
                        <div style="font-size: 2rem; font-weight: 700; color: #1e3a8a; line-height: 1;" id="restoreCurrentStock">450 un.</div>
                    </div>
                </div>
            </div>

            <!-- Sele√ß√£o de Ordem de Compra -->
            <div class="form-group">
                <label style="font-weight: 600;">Ordem de Compra (Aprovada e Entregue)</label>
                <select id="restorePOSelect" onchange="loadPODetails()" style="font-weight: 500;">
                    <option value="">Selecione uma ordem de compra...</option>
                    <option value="PO-2024-001" data-quantity="500" data-supplier="Fornecedor A" data-date="10/02/2026" data-sku="SKU001">PO-2024-001 - 500 un. (Fornecedor A - 10/02/2026)</option>
                    <option value="PO-2024-002" data-quantity="300" data-supplier="Fornecedor B" data-date="09/02/2026" data-sku="SKU002">PO-2024-002 - 300 un. (Fornecedor B - 09/02/2026)</option>
                    <option value="PO-2024-003" data-quantity="200" data-supplier="Fornecedor A" data-date="08/02/2026" data-sku="SKU001">PO-2024-003 - 200 un. (Fornecedor A - 08/02/2026)</option>
                </select>
            </div>

            <!-- Detalhes da Ordem de Compra -->
            <div id="poDetails" style="display: none;">
                <div style="background: var(--gray-50); border: 1px solid var(--gray-300); border-radius: 0.75rem; padding: 1.25rem; margin-bottom: 1.5rem;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <div style="font-size: 0.75rem; color: var(--gray-600); font-weight: 500; margin-bottom: 0.25rem;">FORNECEDOR</div>
                            <div style="font-weight: 600; color: var(--gray-900);" id="poSupplier">-</div>
                        </div>
                        <div>
                            <div style="font-size: 0.75rem; color: var(--gray-600); font-weight: 500; margin-bottom: 0.25rem;">DATA DE ENTREGA</div>
                            <div style="font-weight: 600; color: var(--gray-900);" id="poDate">-</div>
                        </div>
                    </div>
                    <div>
                        <div style="font-size: 0.75rem; color: var(--gray-600); font-weight: 500; margin-bottom: 0.25rem;">QUANTIDADE DISPON√çVEL</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);" id="poQuantity">-</div>
                    </div>
                </div>

                <!-- Input de Quantidade -->
                <div class="form-group">
                    <label style="font-weight: 600;">Quantidade a Restaurar</label>
                    <div style="display: flex; gap: 1rem; align-items: end;">
                        <div style="flex: 1;">
                            <input type="number" id="restoreQuantity" placeholder="0" min="0" oninput="updateRestoreSummary()" style="font-weight: 700; font-size: 1.25rem; text-align: center;">
                            <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">M√°ximo dispon√≠vel: <span id="maxRestoreQty" style="font-weight: 600;">-</span> un.</div>
                        </div>
                        <button class="btn btn-outline" onclick="setMaxRestore()" type="button">M√°ximo</button>
                    </div>
                </div>

                <!-- Preview do Resultado -->
                <div style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border: 2px solid #10b981; border-radius: 0.75rem; padding: 1.25rem; margin-bottom: 1.5rem;">
                    <div style="font-weight: 600; margin-bottom: 0.75rem; color: #065f46; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.25rem;">üìä</span>
                        <span>Resumo da Restaura√ß√£o</span>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; text-align: center;">
                        <div style="background: white; padding: 1rem; border-radius: 0.5rem;">
                            <div style="font-size: 0.75rem; color: #065f46; font-weight: 500; margin-bottom: 0.25rem;">SALDO ATUAL</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: #047857;" id="summaryCurrentBalance">-</div>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 0.5rem;">
                            <div style="font-size: 0.75rem; color: #065f46; font-weight: 500; margin-bottom: 0.25rem;">RECEBENDO</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: #10b981;" id="summaryReceiving">0</div>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 0.5rem;">
                            <div style="font-size: 0.75rem; color: #065f46; font-weight: 500; margin-bottom: 0.25rem;">SALDO FINAL</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: #059669;" id="summaryFinalBalance">-</div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="closeModal('restoreStockModal')">Cancelar</button>
                <button class="btn btn-success" id="confirmRestoreBtn" disabled onclick="confirmRestore()">‚úÖ Confirmar Restaura√ß√£o</button>
            </div>
        </div>
    </div>

    <!-- Report Modal - Generic --><parameter>
    <div id="reportModal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h2 class="modal-title" id="reportModalTitle">üìä Relat√≥rio</h2>
                <button class="close-modal" onclick="closeModal('reportModal')">√ó</button>
            </div>

            <div id="reportContent">
                <!-- Content will be loaded dynamically -->
            </div>

            <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                <button class="btn btn-outline" onclick="closeModal('reportModal')">Fechar</button>
                <button class="btn btn-primary" onclick="exportReport()">üì• Exportar CSV</button>
            </div>
        </div>
    </div>

    <script>
        // Navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Add active class to clicked nav item
            event.currentTarget.classList.add('active');
        }

        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function openPackingModal() {
            // Reset all checkboxes
            document.querySelectorAll('.product-checkbox').forEach(cb => {
                cb.checked = false;
                cb.disabled = false;
            });
            openModal('packingModal');
        }

        // Loading Bar
        function showLoadingBar() {
            const bar = document.getElementById('loadingBar');
            const progress = document.getElementById('loadingBarProgress');
            bar.classList.add('active');
            progress.classList.add('active');
            progress.style.width = '0%';
            
            // Animate to 30%
            setTimeout(() => progress.style.width = '30%', 100);
            
            // Animate to 60%
            setTimeout(() => progress.style.width = '60%', 800);
            
            // Animate to 100%
            setTimeout(() => progress.style.width = '100%', 1800);
            
            // Hide after 3 seconds
            setTimeout(() => {
                bar.classList.remove('active');
                progress.classList.remove('active');
                progress.style.width = '0%';
            }, 3000);
        }

        // Packing - Handle product checkbox
        function handleProductCheck(checkbox) {
            const productId = checkbox.getAttribute('data-product');
            const boxId = checkbox.getAttribute('data-box');
            
            if (checkbox.checked) {
                // Disable this product in all other boxes
                document.querySelectorAll(`.product-checkbox[data-product="${productId}"]`).forEach(cb => {
                    if (cb.getAttribute('data-box') !== boxId) {
                        cb.disabled = true;
                        cb.parentElement.style.opacity = '0.5';
                    }
                });
            } else {
                // Check if product is checked in any other box
                const isCheckedElsewhere = Array.from(
                    document.querySelectorAll(`.product-checkbox[data-product="${productId}"]:checked`)
                ).some(cb => cb.getAttribute('data-box') !== boxId);
                
                if (!isCheckedElsewhere) {
                    // Re-enable product in all boxes
                    document.querySelectorAll(`.product-checkbox[data-product="${productId}"]`).forEach(cb => {
                        cb.disabled = false;
                        cb.parentElement.style.opacity = '1';
                    });
                }
            }
        }

        function finishPacking() {
            const boxCount = document.querySelectorAll('.box-item').length;
            alert(`Pedido embalado com sucesso em ${boxCount} caixa(s)! Etiquetas de envio geradas.`);
            closeModal('packingModal');
        }

        // Scanner Mode
        function openScannerMode() {
            openModal('scannerModal');
            setTimeout(() => {
                document.getElementById('scannerInput').focus();
            }, 100);
        }

        let boxCounter = 1;

        // Add new box in packing
        function addBox() {
            boxCounter++;
            const boxesList = document.getElementById('boxesList');
            const newBox = document.createElement('div');
            newBox.className = 'box-item';
            newBox.setAttribute('data-box', boxCounter);
            newBox.innerHTML = `
                <div style="border: 2px solid var(--gray-300); border-radius: 0.5rem; padding: 1rem; margin-bottom: 0.75rem; background: white;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                        <strong style="color: var(--gray-700); font-size: 1.1rem;">üì¶ Caixa ${boxCounter}</strong>
                        <button class="btn btn-outline btn-sm" onclick="removeBox(${boxCounter})" style="padding: 0.25rem 0.5rem;">‚ùå</button>
                    </div>
                    
                    <div style="background: var(--gray-50); padding: 1rem; border-radius: 0.5rem; margin-bottom: 0.75rem;">
                        <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-700);">Produtos nesta caixa:</div>
                        <label style="display: flex; align-items: center; margin-bottom: 0.5rem; cursor: pointer;">
                            <input type="checkbox" class="product-checkbox" data-product="mochila" data-box="${boxCounter}" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                            <span>Mochila Notebook 15" - 1x</span>
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 0.5rem; cursor: pointer;">
                            <input type="checkbox" class="product-checkbox" data-product="mouse" data-box="${boxCounter}" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                            <span>Mouse Sem Fio - 2x</span>
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 0.5rem; cursor: pointer;">
                            <input type="checkbox" class="product-checkbox" data-product="teclado" data-box="${boxCounter}" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                            <span>Teclado Mec√¢nico - 1x</span>
                        </label>
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" class="product-checkbox" data-product="mousepad" data-box="${boxCounter}" onchange="handleProductCheck(this)" style="width: auto; margin-right: 0.5rem;">
                            <span>Mousepad Gamer - 1x</span>
                        </label>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 0.75rem;">
                        <label>Tipo de Embalagem</label>
                        <select>
                            <option>Caixa Pequena (20x15x10cm)</option>
                            <option selected>Caixa M√©dia (30x25x15cm)</option>
                            <option>Caixa Grande (40x35x20cm)</option>
                            <option>Envelope Pl√°stico</option>
                        </select>
                    </div>

                    <div class="grid grid-2">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Peso (kg)</label>
                            <input type="number" step="0.1" value="1.0" placeholder="0.0">
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>C√≥digo de Rastreio</label>
                            <input type="text" placeholder="BR123456789BR">
                        </div>
                    </div>
                </div>
            `;
            boxesList.appendChild(newBox);
            
            // Update existing checkboxes states
            updateAllProductCheckboxes();
        }

        function removeBox(boxId) {
            const boxes = document.querySelectorAll('.box-item');
            if (boxes.length > 1) {
                const box = document.querySelector(`[data-box="${boxId}"]`);
                if (box) {
                    box.remove();
                    updateAllProductCheckboxes();
                }
            } else {
                alert('Deve haver pelo menos uma caixa!');
            }
        }

        function updateAllProductCheckboxes() {
            // Reset all checkboxes
            document.querySelectorAll('.product-checkbox').forEach(cb => {
                const productId = cb.getAttribute('data-product');
                const isChecked = Array.from(
                    document.querySelectorAll(`.product-checkbox[data-product="${productId}"]:checked`)
                ).length > 0;
                
                if (isChecked && !cb.checked) {
                    cb.disabled = true;
                    cb.parentElement.style.opacity = '0.5';
                } else if (!isChecked) {
                    cb.disabled = false;
                    cb.parentElement.style.opacity = '1';
                }
            });
        }

        // Scanner input handling
        document.addEventListener('DOMContentLoaded', function() {
            const scannerInput = document.getElementById('scannerInput');
            if (scannerInput) {
                scannerInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const scannedCode = this.value;
                        validateScan(scannedCode);
                        this.value = '';
                    }
                });
            }

            // Platform select change handler
            const platformSelect = document.getElementById('platformSelect');
            if (platformSelect) {
                platformSelect.addEventListener('change', function() {
                    const customDiv = document.getElementById('customPlatformName');
                    if (this.value === 'custom') {
                        customDiv.style.display = 'block';
                    } else {
                        customDiv.style.display = 'none';
                    }
                });
            }

            // Position preview update
            const positionInputs = document.querySelectorAll('#addPositionModal input[type="text"]');
            positionInputs.forEach(input => {
                input.addEventListener('input', updatePositionPreview);
            });

            // Initialize first position field with ESTOQUE type
            const firstPositionTypeSelect = document.querySelector('#positionFields .position-type-select');
            if (firstPositionTypeSelect) {
                updatePositionOptions(firstPositionTypeSelect);
            }

            // Initialize first barcode field
            updateRemoveBarcodeButtons();
        });

        function validateScan(code) {
            const feedback = document.getElementById('scannerFeedback');
            feedback.style.display = 'block';
            
            // Simulate validation
            if (code === '7891234567890') {
                feedback.innerHTML = `
                    <div style="background: #d1fae5; border: 1px solid #10b981; padding: 1rem; border-radius: 0.5rem;">
                        <div style="color: #065f46; font-weight: 600; margin-bottom: 0.25rem;">‚úÖ Item Coletado!</div>
                        <div style="color: #047857; font-size: 0.875rem;">Camiseta Premium - Azul M (2 unidades)</div>
                    </div>
                `;
                setTimeout(() => {
                    alert('Item coletado! Pr√≥ximo item carregado.');
                    closeModal('scannerModal');
                }, 1500);
            } else {
                feedback.innerHTML = `
                    <div style="background: #fee2e2; border: 1px solid #ef4444; padding: 1rem; border-radius: 0.5rem;">
                        <div style="color: #991b1b; font-weight: 600; margin-bottom: 0.25rem;">‚ùå C√≥digo Inv√°lido</div>
                        <div style="color: #dc2626; font-size: 0.875rem;">C√≥digo n√£o corresponde ao item esperado</div>
                    </div>
                `;
            }
        }

        function collectItem() {
            alert('Item coletado com sucesso! Pr√≥ximo item carregado.');
        }

        function reportOutOfStock() {
            closeModal('scannerModal');
            openModal('outOfStockModal');
        }

        function handleOutOfStock() {
            const action = document.getElementById('outOfStockAction').value;
            let message = '';
            
            switch(action) {
                case 'purchase_order':
                    message = 'Ordem de compra criada automaticamente! Alerta registrado.';
                    break;
                case 'alert':
                    message = 'Alerta de falta de estoque registrado!';
                    break;
                case 'skip':
                    message = 'Item marcado como pendente. Continuando separa√ß√£o...';
                    break;
            }
            
            alert(message);
            closeModal('outOfStockModal');
        }

        function createWave() {
            alert('Nova onda de separa√ß√£o criada com sucesso!');
            closeModal('newWaveModal');
        }

        function addBarcodeField() {
            const container = document.getElementById('barcodeFields');
            const barcodeCount = container.children.length + 1;
            
            const newBarcode = document.createElement('div');
            newBarcode.className = 'barcode-item';
            newBarcode.style.cssText = 'border: 1px solid var(--gray-300); background: white; padding: 1rem; border-radius: 0.75rem; margin-bottom: 1rem;';
            
            newBarcode.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                    <div style="width: 36px; height: 36px; background: #ede9fe; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; font-size: 1.125rem;">
                        üìä
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; color: var(--gray-700); font-size: 0.875rem;">
                            C√≥digo Adicional #${barcodeCount}
                        </div>
                        <div style="font-size: 0.75rem; color: var(--gray-600);">
                            C√≥digo alternativo (ex: caixa, display)
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-2" style="gap: 0.75rem;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Tipo *</label>
                        <select class="barcode-type-select" style="border: 1px solid var(--gray-300); font-weight: 500;">
                            <option value="ean13">EAN-13 (13 d√≠gitos)</option>
                            <option value="dun14">DUN-14 (14 d√≠gitos)</option>
                            <option value="ean8">EAN-8 (8 d√≠gitos)</option>
                            <option value="upc">UPC-A (12 d√≠gitos)</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">C√≥digo *</label>
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="text" class="barcode-input" placeholder="Ex: 7891234567890" maxlength="14" style="flex: 1; border: 1px solid var(--gray-300); font-weight: 500; font-family: 'Courier New', monospace;">
                            <button class="btn btn-outline btn-sm remove-barcode-btn" onclick="removeBarcodeField(this)" type="button" style="background: var(--gray-50); border-color: var(--gray-300);">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(newBarcode);
            updateRemoveBarcodeButtons();
        }

        function removeBarcodeField(button) {
            const barcodeItem = button.closest('.barcode-item');
            const container = document.getElementById('barcodeFields');
            
            if (container.children.length === 1) {
                alert('‚ö†Ô∏è √â necess√°rio ter pelo menos um c√≥digo de barras cadastrado.');
                return;
            }
            
            barcodeItem.remove();
            updateRemoveBarcodeButtons();
        }

        function updateRemoveBarcodeButtons() {
            const container = document.getElementById('barcodeFields');
            const barcodes = container.querySelectorAll('.barcode-item');
            
            barcodes.forEach((item, index) => {
                const removeBtn = item.querySelector('.remove-barcode-btn');
                const title = item.querySelector('div > div > div:first-child');
                if (removeBtn) {
                    if (barcodes.length === 1) {
                        removeBtn.style.display = 'none';
                        if (title) title.textContent = 'C√≥digo Principal';
                    } else {
                        removeBtn.style.display = 'block';
                        if (title && index === 0) {
                            title.textContent = 'C√≥digo Principal';
                        } else if (title) {
                            title.textContent = `C√≥digo Adicional #${index + 1}`;
                        }
                    }
                }
            });
        }

        function addPositionField() {
            const container = document.getElementById('positionFields');
            const positionCount = container.children.length + 1;
            
            const newPosition = document.createElement('div');
            newPosition.className = 'position-item';
            newPosition.setAttribute('data-position-type', 'estoque');
            newPosition.style.cssText = 'border: 1px solid var(--gray-300); background: white; padding: 1.25rem; border-radius: 0.75rem; margin-bottom: 1rem; transition: all 0.3s;';
            
            newPosition.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div class="position-icon" style="width: 36px; height: 36px; background: #dcfce7; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; font-size: 1.125rem;">
                            üè™
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--gray-700); font-size: 0.938rem;">
                                Posi√ß√£o <span class="position-number">${positionCount}</span>
                            </div>
                            <div class="position-type-label" style="font-size: 0.75rem; color: #059669; font-weight: 500;">
                                ESTOQUE
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-outline btn-sm remove-position-btn" onclick="removePositionField(this)" type="button" style="background: var(--gray-50); border-color: var(--gray-300);">
                        üóëÔ∏è Remover
                    </button>
                </div>
                
                <div class="grid grid-2" style="gap: 0.75rem; margin-bottom: 0.75rem;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Tipo da Posi√ß√£o *</label>
                        <select class="position-type-select" onchange="updatePositionOptions(this)" style="border: 1px solid var(--gray-300); font-weight: 500;">
                            <option value="estoque">üè™ ESTOQUE (Origem para Abastecimento)</option>
                            <option value="pulmao">üì¶ PULM√ÉO (Reserva R√°pida)</option>
                            <option value="picking">üéØ PICKING (Separa√ß√£o Ativa)</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Posi√ß√£o F√≠sica *</label>
                        <select class="position-location-select" style="border: 1px solid var(--gray-300); font-weight: 500;">
                            <option value="">Selecione uma posi√ß√£o</option>
                            <!-- Op√ß√µes ser√£o preenchidas via JS baseado no tipo -->
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-3" style="gap: 0.75rem;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Qtd. Inicial</label>
                        <input type="number" class="position-qty" value="0" placeholder="0" min="0" style="border: 1px solid var(--gray-300); font-weight: 500;">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Estoque M√≠n.</label>
                        <input type="number" class="position-min" value="10" placeholder="10" min="0" style="border: 1px solid var(--gray-300); font-weight: 500;">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.813rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.375rem;">Estoque M√°x.</label>
                        <input type="number" class="position-max" value="100" placeholder="100" min="0" style="border: 1px solid var(--gray-300); font-weight: 500;">
                    </div>
                </div>
            `;
            container.appendChild(newPosition);
            updatePositionNumbers();
            updateRemoveButtons();
            updatePositionOptions(newPosition.querySelector('.position-type-select'));
        }

        function openReplenishmentModal(sku = null, location = null) {
            openModal('replenishmentModal');
            
            if (sku) {
                document.getElementById('replenishProductSelect').value = sku;
                loadProductReplenishmentInfo();
            }
        }

        function removePositionField(button) {
            const positionItem = button.closest('.position-item');
            const container = document.getElementById('positionFields');
            const estoquePosicoes = container.querySelectorAll('[data-position-type="estoque"]');
            
            if (positionItem.getAttribute('data-position-type') === 'estoque' && estoquePosicoes.length === 1) {
                alert('‚ö†Ô∏è N√£o √© poss√≠vel remover a √∫ltima posi√ß√£o de ESTOQUE. √â obrigat√≥rio ter pelo menos uma.');
                return;
            }
            
            positionItem.remove();
            updatePositionNumbers();
            updateRemoveButtons();
        }

        function updatePositionNumbers() {
            const positions = document.querySelectorAll('.position-item');
            positions.forEach((pos, index) => {
                const numberSpan = pos.querySelector('.position-number');
                if (numberSpan) numberSpan.textContent = index + 1;
            });
        }

        function updateRemoveButtons() {
            const container = document.getElementById('positionFields');
            const estoquePosicoes = container.querySelectorAll('[data-position-type="estoque"]');
            
            estoquePosicoes.forEach(pos => {
                const removeBtn = pos.querySelector('.remove-position-btn');
                const typeLabel = pos.querySelector('.position-type-label');
                if (removeBtn) {
                    if (estoquePosicoes.length === 1) {
                        removeBtn.style.display = 'none';
                        if (typeLabel) typeLabel.textContent = 'ESTOQUE (Obrigat√≥rio)';
                    } else {
                        removeBtn.style.display = 'block';
                        if (typeLabel && typeLabel.textContent.includes('Obrigat√≥rio')) {
                            typeLabel.textContent = 'ESTOQUE';
                        }
                    }
                }
            });
        }

        function updatePositionOptions(selectElement) {
            const positionItem = selectElement.closest('.position-item');
            const selectedType = selectElement.value;
            const locationSelect = positionItem.querySelector('.position-location-select');
            const icon = positionItem.querySelector('.position-icon');
            const typeLabel = positionItem.querySelector('.position-type-label');
            
            const typeConfig = {
                'estoque': { icon: 'üè™', bg: '#dcfce7', color: '#059669', label: 'ESTOQUE',
                    locations: [
                        { value: 'E-01-1', text: 'E-01-1 (Estoque - Livre)' },
                        { value: 'E-01-2', text: 'E-01-2 (Estoque - Livre)' },
                        { value: 'E-02-1', text: 'E-02-1 (Estoque - Livre)' },
                        { value: 'E-02-2', text: 'E-02-2 (Estoque - Livre)' },
                        { value: 'E-03-1', text: 'E-03-1 (Estoque - Livre)' }
                    ]
                },
                'pulmao': { icon: 'üì¶', bg: '#fef3c7', color: '#d97706', label: 'PULM√ÉO',
                    locations: [
                        { value: 'P-01-1', text: 'P-01-1 (Pulm√£o - Livre)' },
                        { value: 'P-01-2', text: 'P-01-2 (Pulm√£o - Livre)' },
                        { value: 'P-02-1', text: 'P-02-1 (Pulm√£o - Livre)' },
                        { value: 'P-02-2', text: 'P-02-2 (Pulm√£o - Livre)' }
                    ]
                },
                'picking': { icon: 'üéØ', bg: '#dbeafe', color: '#0284c7', label: 'PICKING',
                    locations: [
                        { value: 'A-12-3', text: 'A-12-3 (Picking - Livre)' },
                        { value: 'A-12-4', text: 'A-12-4 (Picking - Livre)' },
                        { value: 'B-08-2', text: 'B-08-2 (Picking - Livre)' },
                        { value: 'C-15-1', text: 'C-15-1 (Picking - Livre)' },
                        { value: 'D-20-5', text: 'D-20-5 (Picking - Livre)' }
                    ]
                }
            };
            
            const config = typeConfig[selectedType];
            icon.textContent = config.icon;
            icon.style.background = config.bg;
            
            positionItem.setAttribute('data-position-type', selectedType);
            const container = document.getElementById('positionFields');
            const newEstoquePosicoes = container.querySelectorAll('[data-position-type="estoque"]');
            
            if (selectedType === 'estoque' && newEstoquePosicoes.length === 1) {
                typeLabel.textContent = config.label + ' (Obrigat√≥rio)';
            } else {
                typeLabel.textContent = config.label;
            }
            typeLabel.style.color = config.color;
            
            locationSelect.innerHTML = '<option value="">Selecione uma posi√ß√£o</option>';
            config.locations.forEach(loc => {
                const option = document.createElement('option');
                option.value = loc.value;
                option.textContent = loc.text;
                locationSelect.appendChild(option);
            });
            
            updateRemoveButtons();
        }

        function loadProductReplenishmentInfo() {
            const input = document.getElementById('replenishProductSelect');
            const infoDiv = document.getElementById('replenishmentInfo');
            const confirmBtn = document.getElementById('confirmReplenishmentBtn');
            const originDatalist = document.getElementById('originDatalist');
            
            if (input.value && input.value.trim() !== '') {
                infoDiv.style.display = 'block';
                
                // Simular posi√ß√µes do produto (em produ√ß√£o viria do banco de dados)
                const mockPositions = [
                    { id: 'E-01-1', name: 'E-01-1', type: 'estoque', icon: 'üè™', label: 'ESTOQUE', current: 120, min: 50, max: 500 },
                    { id: 'E-02-1', name: 'E-02-1', type: 'estoque', icon: 'üè™', label: 'ESTOQUE', current: 80, min: 50, max: 500 },
                    { id: 'P-01-1', name: 'P-01-1', type: 'pulmao', icon: 'üì¶', label: 'PULM√ÉO', current: 30, min: 20, max: 100 },
                    { id: 'P-02-1', name: 'P-02-1', type: 'pulmao', icon: 'üì¶', label: 'PULM√ÉO', current: 15, min: 20, max: 100 },
                    { id: 'A-12-3', name: 'A-12-3', type: 'picking', icon: 'üéØ', label: 'PICKING', current: 25, min: 20, max: 200 },
                    { id: 'B-08-2', name: 'B-08-2', type: 'picking', icon: 'üéØ', label: 'PICKING', current: 10, min: 15, max: 150 }
                ];
                
                // Armazenar posi√ß√µes globalmente para uso posterior
                window.currentProductPositions = mockPositions;
                
                // Preencher datalist de origem
                originDatalist.innerHTML = '';
                mockPositions.forEach(pos => {
                    const option = document.createElement('option');
                    option.value = pos.id;
                    option.textContent = `${pos.icon} ${pos.name} (${pos.label}) - ${pos.current} un.`;
                    option.setAttribute('data-type', pos.type);
                    option.setAttribute('data-current', pos.current);
                    option.setAttribute('data-icon', pos.icon);
                    option.setAttribute('data-label', pos.label);
                    originDatalist.appendChild(option);
                });
                
                // Resetar outros campos
                const destInput = document.getElementById('replenishDestinationSelect');
                const destScanBtn = document.getElementById('destinationScanBtn');
                destInput.disabled = true;
                destInput.value = '';
                destScanBtn.disabled = true;
                document.getElementById('destinationDatalist').innerHTML = '';
                document.getElementById('originInfo').style.display = 'none';
                document.getElementById('flowVisualization').style.display = 'none';
                document.getElementById('replenishmentForm').style.display = 'none';
                document.getElementById('replenishmentSummary').style.display = 'none';
                confirmBtn.disabled = true;
            } else {
                infoDiv.style.display = 'none';
                confirmBtn.disabled = true;
            }
        }

        function updateReplenishmentDestinations() {
            const originInput = document.getElementById('replenishOriginSelect');
            const destInput = document.getElementById('replenishDestinationSelect');
            const destScanBtn = document.getElementById('destinationScanBtn');
            const originInfo = document.getElementById('originInfo');
            const originDatalist = document.getElementById('originDatalist');
            
            if (!originInput.value || originInput.value.trim() === '') {
                destInput.disabled = true;
                destScanBtn.disabled = true;
                destInput.value = '';
                document.getElementById('destinationDatalist').innerHTML = '';
                originInfo.style.display = 'none';
                document.getElementById('flowVisualization').style.display = 'none';
                document.getElementById('replenishmentForm').style.display = 'none';
                document.getElementById('replenishmentSummary').style.display = 'none';
                return;
            }
            
            // Buscar dados da op√ß√£o selecionada no datalist
            const selectedOption = Array.from(originDatalist.options).find(opt => opt.value === originInput.value);
            if (!selectedOption) return;
            
            const originType = selectedOption.getAttribute('data-type');
            const originCurrent = selectedOption.getAttribute('data-current');
            const originIcon = selectedOption.getAttribute('data-icon');
            const originLabel = selectedOption.getAttribute('data-label');
            
            // Mostrar info da origem
            originInfo.style.display = 'block';
            document.getElementById('originIcon').textContent = originIcon;
            document.getElementById('originPositionName').textContent = originInput.value;
            document.getElementById('originTypeLabel').textContent = originLabel;
            document.getElementById('originStock').textContent = originCurrent + ' un.';
            
            // Atualizar barra de progresso da origem
            const originPosition = window.currentProductPositions.find(p => p.id === originInput.value);
            if (originPosition) {
                const percentage = (originPosition.current / originPosition.max * 100).toFixed(0);
                document.getElementById('originCapacityText').textContent = percentage + '% utilizado';
                document.getElementById('originProgressBar').style.width = percentage + '%';
            }
            
            // Mostrar visualiza√ß√£o de fluxo
            const flowViz = document.getElementById('flowVisualization');
            flowViz.style.display = 'block';
            document.getElementById('flowOriginIcon').textContent = originIcon;
            document.getElementById('flowOriginName').textContent = originInput.value;
            
            // Definir hierarquia: ESTOQUE -> PULM√ÉO/PICKING, PULM√ÉO -> PICKING
            let allowedDestTypes = [];
            if (originType === 'estoque') {
                allowedDestTypes = ['pulmao', 'picking'];
            } else if (originType === 'pulmao') {
                allowedDestTypes = ['picking'];
            }
            
            // Filtrar e preencher destinos no datalist
            const destDatalist = document.getElementById('destinationDatalist');
            destDatalist.innerHTML = '';
            
            if (allowedDestTypes.length === 0) {
                destInput.disabled = true;
                destScanBtn.disabled = true;
            } else {
                destInput.disabled = false;
                destScanBtn.disabled = false;
                const positions = window.currentProductPositions || [];
                const validDestinations = positions.filter(pos => 
                    allowedDestTypes.includes(pos.type) && pos.id !== originInput.value
                );
                
                if (validDestinations.length > 0) {
                    validDestinations.forEach(pos => {
                        const option = document.createElement('option');
                        option.value = pos.id;
                        option.textContent = `${pos.icon} ${pos.name} (${pos.label}) - ${pos.current} un.`;
                        option.setAttribute('data-type', pos.type);
                        option.setAttribute('data-current', pos.current);
                        option.setAttribute('data-min', pos.min);
                        option.setAttribute('data-max', pos.max);
                        option.setAttribute('data-icon', pos.icon);
                        destDatalist.appendChild(option);
                    });
                }
            }
            
            // Esconder formul√°rio at√© selecionar destino
            document.getElementById('replenishmentForm').style.display = 'none';
            document.getElementById('replenishmentSummary').style.display = 'none';
        }

        function updateReplenishmentForm() {
            const destInput = document.getElementById('replenishDestinationSelect');
            const form = document.getElementById('replenishmentForm');
            const destDatalist = document.getElementById('destinationDatalist');
            
            if (!destInput.value || destInput.value.trim() === '') {
                form.style.display = 'none';
                document.getElementById('replenishmentSummary').style.display = 'none';
                return;
            }
            
            // Buscar dados da op√ß√£o selecionada no datalist
            const selectedOption = Array.from(destDatalist.options).find(opt => opt.value === destInput.value);
            if (!selectedOption) return;
            
            const destCurrent = parseInt(selectedOption.getAttribute('data-current'));
            const destMin = parseInt(selectedOption.getAttribute('data-min'));
            const destMax = parseInt(selectedOption.getAttribute('data-max'));
            const destIcon = selectedOption.getAttribute('data-icon');
            
            // Atualizar visualiza√ß√£o de fluxo
            document.getElementById('flowDestIcon').textContent = destIcon;
            document.getElementById('flowDestName').textContent = destInput.value;
            // Preencher informa√ß√µes do destino
            document.getElementById('destIcon').textContent = destIcon;
            document.getElementById('destPositionName').textContent = destInput.value;
            document.getElementById('destCurrent').textContent = destCurrent;
            document.getElementById('destMin').textContent = destMin;
            document.getElementById('destMax').textContent = destMax;
            
            // Atualizar barra de progresso do destino
            const destPercentage = (destCurrent / destMax * 100).toFixed(0);
            document.getElementById('destCapacityText').textContent = destPercentage + '% ocupado';
            document.getElementById('destProgressBar').style.width = destPercentage + '%';
            
            // Status
            const statusBadge = document.getElementById('destStatus');
            if (destCurrent < destMin) {
                statusBadge.className = 'badge badge-warning';
                statusBadge.textContent = '‚ö†Ô∏è Abaixo do M√≠nimo';
            } else if (destCurrent >= destMax) {
                statusBadge.className = 'badge badge-danger';
                statusBadge.textContent = 'üî¥ Cheio';
            } else {
                statusBadge.className = 'badge badge-success';
                statusBadge.textContent = '‚úÖ OK';
            }
            
            // Configurar input de quantidade
            const originInput = document.getElementById('replenishOriginSelect');
            const originDatalist = document.getElementById('originDatalist');
            const originOption = Array.from(originDatalist.options).find(opt => opt.value === originInput.value);
            const originCurrent = parseInt(originOption.getAttribute('data-current'));
            const maxTransfer = Math.min(originCurrent, destMax - destCurrent);
            
            const quantityInput = document.getElementById('replenishQuantity');
            quantityInput.max = maxTransfer;
            quantityInput.value = 0;
            
            document.getElementById('finalBalance').value = destCurrent;
            
            // Sugest√£o
            const suggestionBox = document.getElementById('suggestionBox');
            const suggestionText = document.getElementById('suggestionText');
            if (destCurrent < destMin) {
                const needed = destMin - destCurrent;
                const suggested = Math.min(needed, maxTransfer);
                suggestionBox.style.display = 'block';
                suggestionText.textContent = `Abastecer ${suggested} unidades para atingir o m√≠nimo de ${destMin} un.`;
                quantityInput.value = suggested;
                document.getElementById('finalBalance').value = destCurrent + suggested;
            } else {
                suggestionBox.style.display = 'none';
            }
            
            form.style.display = 'block';
            updateReplenishmentSummary();
        }

        function updateReplenishmentSummary() {
            const quantityInput = document.getElementById('replenishQuantity');
            const finalBalance = document.getElementById('finalBalance');
            const destInput = document.getElementById('replenishDestinationSelect');
            const originInput = document.getElementById('replenishOriginSelect');
            const confirmBtn = document.getElementById('confirmReplenishmentBtn');
            
            if (!destInput.value) return;
            
            const destDatalist = document.getElementById('destinationDatalist');
            const selectedDestOption = Array.from(destDatalist.options).find(opt => opt.value === destInput.value);
            if (!selectedDestOption) return;
            
            const destCurrent = parseInt(selectedDestOption.getAttribute('data-current'));
            const quantity = parseInt(quantityInput.value) || 0;
            
            // Atualizar saldo final
            finalBalance.value = destCurrent + quantity;
            
            // Mostrar resumo
            const summary = document.getElementById('replenishmentSummary');
            if (quantity > 0) {
                summary.style.display = 'block';
                document.getElementById('summaryQuantity').textContent = quantity + ' un.';
                
                const originDatalist = document.getElementById('originDatalist');
                const originOption = Array.from(originDatalist.options).find(opt => opt.value === originInput.value);
                const originCurrent = parseInt(originOption.getAttribute('data-current'));
                document.getElementById('summaryOriginRemaining').textContent = (originCurrent - quantity) + ' un.';
                
                confirmBtn.disabled = false;
            } else {
                summary.style.display = 'none';
                confirmBtn.disabled = true;
            }
        }

        // Fun√ß√µes do Scanner
        let currentScannerField = null;

        function openScannerModal(fieldType) {
            currentScannerField = fieldType;
            const scannerInput = document.getElementById('scannerInput');
            const scannerSubtitle = document.getElementById('scannerSubtitle');
            const scannerContext = document.getElementById('scannerContextText');
            
            scannerInput.value = '';
            document.getElementById('scannerFeedback').style.display = 'none';
            
            // Configurar contexto baseado no tipo
            if (fieldType === 'product') {
                scannerSubtitle.textContent = 'Bipe o c√≥digo de barras do produto';
                scannerContext.textContent = 'Esperando c√≥digo de produto (EAN/SKU)';
            } else if (fieldType === 'origin') {
                scannerSubtitle.textContent = 'Bipe o c√≥digo da posi√ß√£o de origem';
                scannerContext.textContent = 'Esperando c√≥digo da posi√ß√£o (ex: E-01-1, P-01-1)';
            } else if (fieldType === 'destination') {
                scannerSubtitle.textContent = 'Bipe o c√≥digo da posi√ß√£o de destino';
                scannerContext.textContent = 'Esperando c√≥digo da posi√ß√£o (ex: A-12-3, B-08-2)';
            }
            
            openModal('scannerModal');
            setTimeout(() => scannerInput.focus(), 300);
            
            // Auto processar quando Enter for pressionado
            scannerInput.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    processScannerInput();
                }
            };
        }

        function closeScannerModal() {
            closeModal('scannerModal');
            currentScannerField = null;
        }

        function processScannerInput() {
            const scannerInput = document.getElementById('scannerInput');
            const scannedValue = scannerInput.value.trim().toUpperCase();
            const feedback = document.getElementById('scannerFeedback');
            
            if (!scannedValue) {
                feedback.style.display = 'block';
                feedback.style.background = '#fee2e2';
                feedback.style.border = '2px solid #ef4444';
                feedback.innerHTML = '<div style="color: #991b1b; font-weight: 600;">‚ùå C√≥digo inv√°lido ou vazio</div>';
                return;
            }
            
            // Preencher o campo correspondente
            if (currentScannerField === 'product') {
                document.getElementById('replenishProductSelect').value = scannedValue;
                loadProductReplenishmentInfo();
            } else if (currentScannerField === 'origin') {
                document.getElementById('replenishOriginSelect').value = scannedValue;
                updateReplenishmentDestinations();
            } else if (currentScannerField === 'destination') {
                document.getElementById('replenishDestinationSelect').value = scannedValue;
                updateReplenishmentForm();
            }
            
            // Feedback de sucesso
            feedback.style.display = 'block';
            feedback.style.background = '#d1fae5';
            feedback.style.border = '2px solid #10b981';
            feedback.innerHTML = `
                <div style="color: #065f46; font-weight: 600;">‚úÖ C√≥digo lido com sucesso!</div>
                <div style="color: #047857; font-size: 0.875rem; margin-top: 0.25rem;">${scannedValue}</div>
            `;
            
            setTimeout(() => {
                closeScannerModal();
            }, 1000);
        }

        function confirmReplenishment() {
            const product = document.getElementById('replenishProductSelect').value;
            const origin = document.getElementById('replenishOriginSelect').value;
            const destination = document.getElementById('replenishDestinationSelect').value;
            const quantity = parseInt(document.getElementById('replenishQuantity').value) || 0;
            
            if (!product || !origin || !destination || quantity <= 0) {
                alert('‚ö†Ô∏è Preencha todos os campos para confirmar o abastecimento.');
                return;
            }
            
            showLoadingBar();
            setTimeout(() => {
                alert(`‚úÖ Abastecimento registrado com sucesso!\n\nüì¶ ${quantity} unidades transferidas\nüîÑ ${origin} ‚Üí ${destination}`);
                closeModal('replenishmentModal');
                
                // Resetar o formul√°rio
                document.getElementById('replenishProductSelect').value = '';
                document.getElementById('replenishmentInfo').style.display = 'none';
                document.getElementById('confirmReplenishmentBtn').disabled = true;
            }, 2000);
        }

        function saveProduct() {
            alert('Produto adicionado com sucesso!');
            closeModal('addProductModal');
        }

        function openEditProductModal(sku) {
            alert(`Abrindo edi√ß√£o do produto: ${sku}`);
        }

        function addProductToManualOrder() {
            const container = document.getElementById('manualOrderProducts');
            const newProduct = document.createElement('div');
            newProduct.className = 'grid grid-3';
            newProduct.style.marginBottom = '0.5rem';
            newProduct.innerHTML = `
                <select style="grid-column: span 2;">
                    <option>Selecione um produto</option>
                    <option>Camiseta Premium Azul M</option>
                    <option>T√™nis Esportivo Preto 42</option>
                    <option>Mochila Notebook 15"</option>
                </select>
                <input type="number" placeholder="Qtd" value="1">
            `;
            container.appendChild(newProduct);
        }

        function saveManualOrder() {
            alert('Pedido manual criado com sucesso!');
            closeModal('manualOrderModal');
        }

        function handleCSVUpload(input) {
            const file = input.files[0];
            if (file) {
                const preview = document.getElementById('csvPreview');
                const content = document.getElementById('csvPreviewContent');
                const btn = document.getElementById('importCSVBtn');
                
                preview.style.display = 'block';
                content.innerHTML = `
                    <div style="font-size: 0.875rem;">
                        <strong>Arquivo:</strong> ${file.name}<br>
                        <strong>Tamanho:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
                        <strong>Status:</strong> <span style="color: var(--success);">‚úÖ Pronto para importar</span>
                    </div>
                `;
                btn.disabled = false;
            }
        }

        function importCSV() {
            showLoadingBar();
            setTimeout(() => {
                alert('Pedidos importados com sucesso! 15 novos pedidos adicionados.');
                closeModal('importOrdersModal');
            }, 3000);
        }

        function syncPlatforms() {
            showLoadingBar();
            setTimeout(() => {
                alert('Sincroniza√ß√£o conclu√≠da! 23 novos pedidos encontrados.');
            }, 3000);
        }

        function syncPlatform(platformName) {
            showLoadingBar();
            setTimeout(() => {
                alert(`${platformName} sincronizado com sucesso!`);
            }, 3000);
        }

        function processOrder(orderId) {
            alert(`Iniciando processamento do pedido ${orderId}...`);
        }

        function connectPlatform() {
            const platform = document.getElementById('platformSelect').value;
            if (platform) {
                showLoadingBar();
                setTimeout(() => {
                    alert(`Plataforma conectada com sucesso! Sincronizando dados...`);
                    closeModal('addPlatformModal');
                }, 3000);
            } else {
                alert('Por favor, selecione uma plataforma');
            }
        }

        function savePlatformConfig() {
            alert('Configura√ß√µes salvas com sucesso!');
            closeModal('platformConfigModal');
        }

        function approvePO() {
            alert('Ordem de compra aprovada e enviada ao fornecedor!');
            closeModal('editPOModal');
        }

        function updatePositionPreview() {
            const inputs = document.querySelectorAll('#addPositionModal input[type="text"]');
            const posto = inputs[0]?.value.toUpperCase() || '-';
            const suposto = inputs[1]?.value || '-';
            const posicao = inputs[2]?.value || '-';
            
            const preview = document.getElementById('positionPreview');
            if (preview) {
                preview.textContent = `${posto}-${suposto}-${posicao}`;
            }
        }

        function loadSupostosForPosto() {
            const postoSelect = document.getElementById('positionPostoSelect');
            const suposto = document.getElementById('positionSupostoSelect');
            const indicator = document.getElementById('postoTypeIndicator');
            const typeValue = document.getElementById('postoTypeValue');
            
            const posto = postoSelect.value;
            
            if (!posto) {
                suposto.disabled = true;
                suposto.innerHTML = '<option value="">Selecione o posto primeiro...</option>';
                indicator.style.display = 'none';
                updatePositionAddress();
                return;
            }
            
            // Pegar tipo do posto
            const selectedOption = postoSelect.options[postoSelect.selectedIndex];
            const postoType = selectedOption.getAttribute('data-type');
            
            // Dados mockados - em produ√ß√£o viria da API
            const postoSupostos = {
                'A': [{code: '01', seq: 1}, {code: '02', seq: 2}, {code: '03', seq: 3}, {code: '04', seq: 4}, {code: '05', seq: 5}],
                'E': [{code: '01', seq: 1}, {code: '02', seq: 2}, {code: '03', seq: 3}],
                'P': [{code: '01', seq: 1}, {code: '02', seq: 2}],
                'B': [{code: '12', seq: 1}, {code: '15', seq: 2}, {code: '08', seq: 3}],
                'C': [{code: '10', seq: 1}, {code: '15', seq: 2}]
            };
            
            const supostosList = postoSupostos[posto] || [];
            
            // Atualizar select de supostos
            suposto.disabled = false;
            suposto.innerHTML = '<option value="">Selecione...</option>';
            supostosList.forEach(s => {
                suposto.innerHTML += `<option value="${s.code}">Suposto ${s.code}</option>`;
            });
            
            // Mostrar tipo do posto
            const typeLabels = {
                'estoque': 'üè™ Estoque',
                'pulmao': 'üì¶ Pulm√£o',
                'picking': 'üéØ Picking',
                'recebimento': 'üì• Recebimento',
                'expedicao': 'üì§ Expedi√ß√£o'
            };
            
            typeValue.textContent = typeLabels[postoType] || '-';
            indicator.style.display = 'block';
            
            updatePositionAddress();
        }

        function enableAddressField() {
            const suposto = document.getElementById('positionSupostoSelect').value;
            const addressField = document.getElementById('positionAddress');
            
            if (suposto) {
                addressField.disabled = false;
                addressField.placeholder = 'Digite o endere√ßo';
                addressField.focus();
            } else {
                addressField.disabled = true;
                addressField.value = '';
                addressField.placeholder = 'Selecione posto e suposto';
            }
        }

        function savePosition() {
            const postoSelect = document.getElementById('positionPostoSelect');
            const posto = postoSelect.value;
            const suposto = document.getElementById('positionSupostoSelect').value;
            const endereco = document.getElementById('positionAddress').value.trim().toUpperCase();
            const editMode = document.getElementById('positionEditMode').value === 'true';
            
            // Valida√ß√µes
            if (!posto) {
                alert('‚ö†Ô∏è Por favor, selecione o posto');
                return;
            }
            
            if (!suposto) {
                alert('‚ö†Ô∏è Por favor, selecione o suposto');
                return;
            }
            
            if (!endereco) {
                alert('‚ö†Ô∏è Por favor, informe o endere√ßo');
                return;
            }
            
            const selectedOption = postoSelect.options[postoSelect.selectedIndex];
            const postoType = selectedOption.getAttribute('data-type');
            
            const typeLabels = {
                'estoque': 'Estoque',
                'pulmao': 'Pulm√£o',
                'picking': 'Picking'
            };
            
            showLoadingBar();
            setTimeout(() => {
                const action = editMode ? 'atualizada' : 'criada';
                alert(`‚úÖ Posi√ß√£o ${action} com sucesso!\n\nüè¢ Posto: ${posto} (${typeLabels[postoType]})\nüìö Suposto: ${suposto}\nüìç Endere√ßo: ${endereco}`);
                closeModal('addPositionModal');
                resetPositionModal();
            }, 1500);
        }

        function resetPositionModal() {
            document.getElementById('positionPostoSelect').value = '';
            document.getElementById('positionSupostoSelect').value = '';
            document.getElementById('positionSupostoSelect').disabled = true;
            document.getElementById('positionSupostoSelect').innerHTML = '<option value="">Selecione o posto primeiro...</option>';
            document.getElementById('positionAddress').value = '';
            document.getElementById('postoTypeIndicator').style.display = 'none';
            document.getElementById('positionEditMode').value = 'false';
            document.getElementById('savePositionBtn').textContent = 'Salvar';
            document.querySelector('#addPositionModal .modal-title').textContent = 'Posi√ß√£o';
        }

        function editPosition(code) {
            // Dados mockados - em produ√ß√£o viria da API
            const mockData = {
                'A-12-3': { posto: 'A', suposto: '12', endereco: '3' },
                'A-12-4': { posto: 'A', suposto: '12', endereco: '4' },
                'B-08-2': { posto: 'B', suposto: '08', endereco: '2' },
                'C-15-1': { posto: 'C', suposto: '15', endereco: '1' }
            };
            
            const position = mockData[code];
            if (!position) {
                alert('‚ö†Ô∏è Posi√ß√£o n√£o encontrada');
                return;
            }
            
            // Configurar modo de edi√ß√£o
            document.getElementById('positionEditMode').value = 'true';
            document.getElementById('savePositionBtn').textContent = 'Atualizar';
            document.querySelector('#addPositionModal .modal-title').textContent = 'Editar Posi√ß√£o';
            
            // Preencher campos
            document.getElementById('positionPostoSelect').value = position.posto;
            loadSupostosForPosto();
            
            // Aguardar o carregamento dos supostos antes de selecionar
            setTimeout(() => {
                document.getElementById('positionSupostoSelect').value = position.suposto;
                enableAddressField();
                document.getElementById('positionAddress').value = position.endereco;
            }, 100);
            
            openModal('addPositionModal');
        }

        function handlePositionsCSVUpload(input) {
            const file = input.files[0];
            if (file) {
                const preview = document.getElementById('positionsCSVPreview');
                const content = document.getElementById('positionsCSVContent');
                const btn = document.getElementById('importPositionsBtn');
                
                preview.style.display = 'block';
                content.innerHTML = `
                    <div style="font-size: 0.875rem;">
                        <strong>Arquivo:</strong> ${file.name}<br>
                        <strong>Tamanho:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
                        <strong>Status:</strong> <span style="color: var(--success);">‚úÖ Pronto para importar</span>
                    </div>
                `;
                btn.disabled = false;
            }
        }

        function importPositions() {
            showLoadingBar();
            setTimeout(() => {
                alert('Posi√ß√µes importadas com sucesso! 50 novas posi√ß√µes cadastradas.');
                closeModal('importPositionsModal');
            }, 3000);
        }

        // ===== FUN√á√ïES DO MODAL DE POSTOS =====

        function addPostoSupostoField() {
            const container = document.getElementById('postoSupostosContainer');
            const count = container.children.length + 1;
            
            const newSuposto = document.createElement('div');
            newSuposto.className = 'posto-suposto-item';
            newSuposto.style.cssText = 'background: var(--gray-50); padding: 1rem; border-radius: 0.75rem; margin-bottom: 0.75rem; border: 2px solid var(--gray-300);';
            newSuposto.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.75rem; align-items: center;">
                    <div>
                        <label style="font-size: 0.75rem; font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem; display: block;">C√≥digo</label>
                        <input type="text" class="suposto-code-input" placeholder="Ex: ${String(count).padStart(2, '0')}" maxlength="3" style="font-weight: 600; font-size: 1rem;" oninput="updatePostoPreview()">
                    </div>
                    <div>
                        <label style="font-size: 0.75rem; font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem; display: block;">Sequ√™ncia</label>
                        <input type="number" class="suposto-sequence-input" placeholder="${count}" min="1" max="999" value="${count}" style="font-weight: 600; font-size: 1rem;" oninput="updatePostoPreview()">
                    </div>
                    <button type="button" class="btn btn-outline btn-sm" onclick="removePostoSupostoField(this)" style="margin-top: 1.25rem;">üóëÔ∏è</button>
                </div>
            `;
            container.appendChild(newSuposto);
            updateRemovePostoSupostoButtons();
            updatePostoPreview();
        }

        function removePostoSupostoField(button) {
            const container = document.getElementById('postoSupostosContainer');
            if (container.children.length > 1) {
                button.closest('.posto-suposto-item').remove();
                updateRemovePostoSupostoButtons();
                updatePostoPreview();
            }
        }

        function updateRemovePostoSupostoButtons() {
            const container = document.getElementById('postoSupostosContainer');
            const removeButtons = container.querySelectorAll('.btn-outline');
            
            removeButtons.forEach(btn => {
                if (container.children.length === 1) {
                    btn.style.display = 'none';
                } else {
                    btn.style.display = 'block';
                }
            });
        }

        function updatePostoPreview() {
            const postoCode = document.getElementById('postoCode').value.trim().toUpperCase();
            const postoSequence = document.getElementById('postoSequence').value;
            const postoType = document.querySelector('input[name="postoType"]:checked').value;
            
            const codeInputs = document.querySelectorAll('.suposto-code-input');
            const sequenceInputs = document.querySelectorAll('.suposto-sequence-input');
            
            const supostos = [];
            codeInputs.forEach((input, index) => {
                const code = input.value.trim();
                const sequence = parseInt(sequenceInputs[index].value) || (index + 1);
                if (code) {
                    supostos.push({ code, sequence });
                }
            });
            
            // Atualizar preview do c√≥digo
            document.getElementById('previewPostoCode').textContent = postoCode || '-';
            
            // Atualizar preview do tipo
            const typeLabels = {
                'estoque': 'üè™ ESTOQUE',
                'pulmao': 'üì¶ PULM√ÉO',
                'picking': 'üéØ PICKING'
            };
            document.getElementById('previewPostoType').textContent = typeLabels[postoType];
            
            // Atualizar preview da sequ√™ncia
            document.getElementById('previewPostoSequence').textContent = postoSequence || '-';
            
            // Atualizar contagem de supostos
            document.getElementById('previewSupostoCount').textContent = supostos.length;
            
            // Atualizar lista de supostos (ordenada por sequ√™ncia)
            const previewList = document.getElementById('previewSupostoList');
            if (supostos.length === 0) {
                previewList.innerHTML = 'Adicione pelo menos um suposto';
                return;
            }
            
            // Verificar duplicatas no c√≥digo
            const codes = supostos.map(s => s.code);
            const uniqueCodes = [...new Set(codes)];
            if (uniqueCodes.length !== codes.length) {
                previewList.innerHTML = '<span style="color: #dc2626;">‚ö†Ô∏è Erro: C√≥digos de suposto n√£o podem repetir!</span>';
                return;
            }
            
            // Verificar duplicatas na sequ√™ncia
            const sequences = supostos.map(s => s.sequence);
            const uniqueSequences = [...new Set(sequences)];
            if (uniqueSequences.length !== sequences.length) {
                previewList.innerHTML = '<span style="color: #dc2626;">‚ö†Ô∏è Erro: Sequ√™ncias n√£o podem repetir!</span>';
                return;
            }
            
            // Ordenar por sequ√™ncia e exibir
            supostos.sort((a, b) => a.sequence - b.sequence);
            let html = '';
            supostos.forEach((suposto, index) => {
                html += `<div style="margin-bottom: 0.5rem;">
                    <strong style="color: var(--primary);">${index + 1}¬∫</strong> ‚Üí 
                    C√≥digo: <strong>${suposto.code}</strong> 
                    (Sequ√™ncia: ${suposto.sequence})
                </div>`;
            });
            previewList.innerHTML = html;
        }

        function savePosto() {
            const postoCode = document.getElementById('postoCode').value.trim().toUpperCase();
            const postoSequence = parseInt(document.getElementById('postoSequence').value) || 0;
            const postoType = document.getElementById('postoTypeSelect').value;
            const editMode = document.getElementById('postoEditMode').value === 'true';
            
            const codeInputs = document.querySelectorAll('.suposto-code-input');
            const sequenceInputs = document.querySelectorAll('.suposto-sequence-input');
            
            const supostos = [];
            codeInputs.forEach((input, index) => {
                const code = input.value.trim();
                const sequence = parseInt(sequenceInputs[index].value) || 0;
                if (code) {
                    supostos.push({ code, sequence });
                }
            });
            
            // Valida√ß√µes
            if (!postoCode) {
                alert('‚ö†Ô∏è Por favor, informe o c√≥digo do posto');
                return;
            }
            
            if (postoSequence === 0) {
                alert('‚ö†Ô∏è Por favor, informe a sequ√™ncia do posto');
                return;
            }
            
            if (supostos.length === 0) {
                alert('‚ö†Ô∏è Por favor, adicione pelo menos um suposto');
                return;
            }
            
            // Verificar duplicatas nos c√≥digos
            const codes = supostos.map(s => s.code);
            const uniqueCodes = [...new Set(codes)];
            if (uniqueCodes.length !== codes.length) {
                alert('‚ö†Ô∏è C√≥digos de suposto n√£o podem repetir!');
                return;
            }
            
            // Verificar duplicatas nas sequ√™ncias
            const sequences = supostos.map(s => s.sequence);
            const uniqueSequences = [...new Set(sequences)];
            if (uniqueSequences.length !== sequences.length) {
                alert('‚ö†Ô∏è Sequ√™ncias de suposto n√£o podem repetir!');
                return;
            }
            
            // Verificar se alguma sequ√™ncia √© 0
            if (sequences.some(s => s === 0)) {
                alert('‚ö†Ô∏è Todas as sequ√™ncias devem ser informadas (maior que 0)');
                return;
            }
            
            const typeLabels = {
                'estoque': 'Estoque',
                'pulmao': 'Pulm√£o',
                'picking': 'Picking',
                'recebimento': 'Recebimento',
                'expedicao': 'Expedi√ß√£o',
                'devolucao': 'Devolu√ß√£o',
                'quarentena': 'Quarentena',
                'avariado': 'Avariado',
                'cross_docking': 'Cross Docking',
                'embalagem': 'Embalagem'
            };
            
            supostos.sort((a, b) => a.sequence - b.sequence);
            const supostosList = supostos.map(s => `${s.code} (seq: ${s.sequence})`).join(', ');
            
            showLoadingBar();
            setTimeout(() => {
                const action = editMode ? 'atualizado' : 'criado';
                alert(`‚úÖ Posto ${action} com sucesso!\n\nüè¢ C√≥digo: ${postoCode}\nüéØ Tipo: ${typeLabels[postoType]}\nüî¢ Sequ√™ncia: ${postoSequence}\nüìö Supostos: ${supostos.length}\nüìã Lista: ${supostosList}`);
                closeModal('addPostoModal');
                resetPostoModal();
            }, 1500);
        }

        function resetPostoModal() {
            document.getElementById('postoCode').value = '';
            document.getElementById('postoSequence').value = '1';
            document.getElementById('postoTypeSelect').value = 'estoque';
            document.getElementById('postoEditMode').value = 'false';
            document.getElementById('savePostoBtn').textContent = 'Salvar';
            document.querySelector('#addPostoModal .modal-title').textContent = 'Posto';
            
            document.querySelectorAll('.suposto-code-input').forEach(input => input.value = '');
            document.querySelectorAll('.suposto-sequence-input').forEach(input => input.value = '');
            
            // Resetar container para ter apenas um suposto
            const container = document.getElementById('postoSupostosContainer');
            while (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
            updateRemovePostoSupostoButtons();
            updatePostoPreview();
        }

        function resetPostoModal() {
            document.getElementById('postoCode').value = '';
            document.getElementById('postoSequence').value = '1';
            document.getElementById('postoTypeSelect').value = 'estoque';
            document.getElementById('postoEditMode').value = 'false';
            document.getElementById('savePostoBtn').textContent = 'Salvar';
            document.querySelector('#addPostoModal .modal-title').textContent = 'Posto';
            
            document.querySelectorAll('.suposto-code-input').forEach(input => input.value = '');
            document.querySelectorAll('.suposto-sequence-input').forEach(input => input.value = '');
            
            // Resetar container para ter apenas um suposto
            const container = document.getElementById('postoSupostosContainer');
            while (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
            updateRemovePostoSupostoButtons();
            updatePostoPreview();
        }

        function editPosto(postoCode) {
            // Dados mockados - em produ√ß√£o viria da API
            const mockData = {
                'A': { code: 'A', type: 'estoque', sequence: 1, supostos: [{code: '01', sequence: 1}, {code: '02', sequence: 2}, {code: '03', sequence: 3}, {code: '04', sequence: 4}, {code: '05', sequence: 5}] },
                'E': { code: 'E', type: 'estoque', sequence: 2, supostos: [{code: '01', sequence: 1}, {code: '02', sequence: 2}, {code: '03', sequence: 3}] },
                'P': { code: 'P', type: 'pulmao', sequence: 3, supostos: [{code: '01', sequence: 1}, {code: '02', sequence: 2}] },
                'B': { code: 'B', type: 'picking', sequence: 4, supostos: [{code: '12', sequence: 1}, {code: '15', sequence: 2}, {code: '08', sequence: 3}] }
            };
            
            const posto = mockData[postoCode];
            if (!posto) {
                alert('‚ö†Ô∏è Posto n√£o encontrado');
                return;
            }
            
            // Configurar modo de edi√ß√£o
            document.getElementById('postoEditMode').value = 'true';
            document.getElementById('savePostoBtn').textContent = 'Atualizar';
            document.querySelector('#addPostoModal .modal-title').textContent = 'Editar Posto';
            
            // Preencher campos
            document.getElementById('postoCode').value = posto.code;
            document.getElementById('postoSequence').value = posto.sequence;
            document.getElementById('postoTypeSelect').value = posto.type;
            
            // Limpar container de supostos
            const container = document.getElementById('postoSupostosContainer');
            while (container.children.length > 0) {
                container.removeChild(container.lastChild);
            }
            
            // Adicionar supostos
            posto.supostos.forEach((suposto, index) => {
                const newSuposto = document.createElement('div');
                newSuposto.className = 'posto-suposto-item';
                newSuposto.style.cssText = 'background: var(--gray-50); padding: 1rem; border-radius: 0.75rem; margin-bottom: 0.75rem; border: 2px solid var(--gray-300);';
                newSuposto.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.75rem; align-items: center;">
                        <div>
                            <label style="font-size: 0.75rem; font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem; display: block;">C√≥digo</label>
                            <input type="text" class="suposto-code-input" placeholder="Ex: ${String(index + 1).padStart(2, '0')}" maxlength="3" style="font-weight: 600; font-size: 1rem;" oninput="updatePostoPreview()" value="${suposto.code}">
                        </div>
                        <div>
                            <label style="font-size: 0.75rem; font-weight: 600; color: var(--gray-600); margin-bottom: 0.25rem; display: block;">Sequ√™ncia</label>
                            <input type="number" class="suposto-sequence-input" placeholder="${index + 1}" min="1" max="999" value="${suposto.sequence}" style="font-weight: 600; font-size: 1rem;" oninput="updatePostoPreview()">
                        </div>
                        <button type="button" class="btn btn-outline btn-sm" onclick="removePostoSupostoField(this)" style="margin-top: 1.25rem;">üóëÔ∏è</button>
                    </div>
                `;
                container.appendChild(newSuposto);
            });
            
            updateRemovePostoSupostoButtons();
            updatePostoPreview();
            openModal('addPostoModal');
        }

        function deletePosto(postoCode) {
            if (confirm(`Deseja realmente excluir o posto ${postoCode}?\n\nTodas as posi√ß√µes vinculadas tamb√©m ser√£o exclu√≠das.`)) {
                showLoadingBar();
                setTimeout(() => {
                    alert(`‚úÖ Posto ${postoCode} exclu√≠do com sucesso!`);
                }, 1000);
            }
        }

        // ===== FUN√á√ïES DE ESTOQUE =====

        function updateStockPreview() {
            const product = document.getElementById('stockProductSelect');
            const position = document.getElementById('stockPositionSelect');
            const initial = document.getElementById('stockInitialBalance').value;
            const min = document.getElementById('stockMinQuantity').value;
            const max = document.getElementById('stockMaxQuantity').value;
            const preview = document.getElementById('stockPreview');
            
            if (!product.value || !position.value) {
                preview.innerHTML = 'Preencha os campos para ver o resumo';
                return;
            }
            
            const productText = product.options[product.selectedIndex].text;
            const positionText = position.options[position.selectedIndex].text;
            
            let status = '‚ö™ Pendente';
            if (initial && min && max) {
                if (parseInt(initial) < parseInt(min)) {
                    status = '‚ö†Ô∏è Abaixo do M√≠nimo';
                } else if (parseInt(initial) >= parseInt(max)) {
                    status = 'üî¥ Cheio';
                } else {
                    status = '‚úÖ OK';
                }
            }
            
            preview.innerHTML = `
                <div style="margin-bottom: 0.5rem;"><strong>üè∑Ô∏è Produto:</strong> ${productText}</div>
                <div style="margin-bottom: 0.5rem;"><strong>üìç Posi√ß√£o:</strong> ${positionText}</div>
                <div style="margin-bottom: 0.5rem;"><strong>üì¶ Saldo Inicial:</strong> ${initial || '-'} un.</div>
                <div style="margin-bottom: 0.5rem;"><strong>üìä Limites:</strong> ${min || '-'} / ${max || '-'}</div>
                <div><strong>üéØ Status:</strong> ${status}</div>
            `;
        }

        function saveStock() {
            const product = document.getElementById('stockProductSelect').value;
            const position = document.getElementById('stockPositionSelect').value;
            const initial = document.getElementById('stockInitialBalance').value;
            const min = document.getElementById('stockMinQuantity').value;
            const max = document.getElementById('stockMaxQuantity').value;
            const editMode = document.getElementById('stockEditMode').value === 'true';
            
            // Valida√ß√µes
            if (!product || !position) {
                alert('‚ö†Ô∏è Selecione o produto e a posi√ß√£o');
                return;
            }
            
            if (!initial || parseInt(initial) < 0) {
                alert('‚ö†Ô∏è Saldo inicial inv√°lido');
                return;
            }
            
            if (!min || !max || parseInt(min) < 0 || parseInt(max) <= 0) {
                alert('‚ö†Ô∏è Quantidades m√≠nima e m√°xima inv√°lidas');
                return;
            }
            
            if (parseInt(min) >= parseInt(max)) {
                alert('‚ö†Ô∏è Quantidade m√≠nima deve ser menor que a m√°xima');
                return;
            }
            
            showLoadingBar();
            
            setTimeout(() => {
                const action = editMode ? 'atualizado' : 'criado';
                alert(`‚úÖ Saldo ${action} com sucesso!\n\nüè∑Ô∏è Produto: ${product}\nüìç Posi√ß√£o: ${position}\nüì¶ Saldo Inicial: ${initial} un.\nüìä Limites: ${min} / ${max}`);
                closeModal('addStockModal');
                resetStockModal();
            }, 1500);
        }

        function resetStockModal() {
            document.getElementById('stockProductSelect').value = '';
            document.getElementById('stockPositionSelect').value = '';
            document.getElementById('stockInitialBalance').value = '';
            document.getElementById('stockMinQuantity').value = '';
            document.getElementById('stockMaxQuantity').value = '';
            document.getElementById('stockEditMode').value = 'false';
            document.getElementById('stockModalTitle').textContent = '‚ûï Novo Saldo';
            document.getElementById('stockPreview').innerHTML = 'Preencha os campos para ver o resumo';
        }

        function editStock(sku, position) {
            // Mockdata - em produ√ß√£o viria da API
            const mockStockData = {
                'SKU001-E-01-1': {
                    product: 'SKU001',
                    position: 'E-01-1',
                    balance: 450,
                    min: 100,
                    max: 1000
                },
                'SKU001-P-01-2': {
                    product: 'SKU001',
                    position: 'P-01-2',
                    balance: 18,
                    min: 20,
                    max: 50
                },
                'SKU001-PK-01-1': {
                    product: 'SKU001',
                    position: 'PK-01-1',
                    balance: 5,
                    min: 10,
                    max: 30
                }
            };
            
            const key = `${sku}-${position}`;
            const stockData = mockStockData[key];
            
            if (!stockData) {
                alert('‚ö†Ô∏è Saldo n√£o encontrado');
                return;
            }
            
            // Configurar modo de edi√ß√£o
            document.getElementById('stockEditMode').value = 'true';
            document.getElementById('stockModalTitle').textContent = '‚úèÔ∏è Editar Saldo';
            
            // Preencher campos
            document.getElementById('stockProductSelect').value = stockData.product;
            document.getElementById('stockPositionSelect').value = stockData.position;
            document.getElementById('stockInitialBalance').value = stockData.balance;
            document.getElementById('stockMinQuantity').value = stockData.min;
            document.getElementById('stockMaxQuantity').value = stockData.max;
            
            updateStockPreview();
            openModal('addStockModal');
        }

        function handleStockCSVUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const content = e.target.result;
                    document.getElementById('stockCSVContent').textContent = content;
                    document.getElementById('stockCSVPreview').style.display = 'block';
                };
                reader.readAsText(file);
            }
        }

        function importStock() {
            showLoadingBar();
            setTimeout(() => {
                alert('‚úÖ Saldos importados com sucesso!');
                closeModal('importStockModal');
            }, 2000);
        }

        // ===== FUN√á√ïES DE RESTAURAR ESTOQUE =====

        function openRestoreStockModal(sku, position) {
            // Mockdata - em produ√ß√£o viria da API
            const mockStockData = {
                'SKU001-E-01-1': {
                    sku: 'SKU001',
                    product: 'Mouse Gamer RGB',
                    position: 'E-01-1',
                    balance: 450
                },
                'SKU002-E-01-2': {
                    sku: 'SKU002',
                    product: 'Teclado Mec√¢nico',
                    position: 'E-01-2',
                    balance: 280
                },
                'SKU003-E-02-1': {
                    sku: 'SKU003',
                    product: 'Monitor 24" Full HD',
                    position: 'E-02-1',
                    balance: 120
                }
            };
            
            const key = `${sku}-${position}`;
            const stockData = mockStockData[key];
            
            if (!stockData) {
                alert('‚ö†Ô∏è Dados do estoque n√£o encontrados');
                return;
            }
            
            // Preencher informa√ß√µes do estoque
            document.getElementById('restorePositionName').textContent = stockData.position;
            document.getElementById('restoreProductName').textContent = `${stockData.sku} - ${stockData.product}`;
            document.getElementById('restoreCurrentStock').textContent = stockData.balance + ' un.';
            
            // Armazenar dados globalmente
            window.currentRestoreStock = stockData;
            
            // Resetar campos
            document.getElementById('restorePOSelect').value = '';
            document.getElementById('restoreQuantity').value = '';
            document.getElementById('poDetails').style.display = 'none';
            document.getElementById('confirmRestoreBtn').disabled = true;
            
            openModal('restoreStockModal');
        }

        function loadPODetails() {
            const poSelect = document.getElementById('restorePOSelect');
            const detailsDiv = document.getElementById('poDetails');
            const confirmBtn = document.getElementById('confirmRestoreBtn');
            
            if (!poSelect.value) {
                detailsDiv.style.display = 'none';
                confirmBtn.disabled = true;
                return;
            }
            
            const selectedOption = poSelect.options[poSelect.selectedIndex];
            const quantity = parseInt(selectedOption.getAttribute('data-quantity'));
            const supplier = selectedOption.getAttribute('data-supplier');
            const date = selectedOption.getAttribute('data-date');
            
            // Preencher detalhes da OC
            document.getElementById('poSupplier').textContent = supplier;
            document.getElementById('poDate').textContent = date;
            document.getElementById('poQuantity').textContent = quantity + ' un.';
            document.getElementById('maxRestoreQty').textContent = quantity;
            
            // Configurar input de quantidade
            const quantityInput = document.getElementById('restoreQuantity');
            quantityInput.max = quantity;
            quantityInput.value = 0;
            
            // Armazenar dados globalmente
            window.currentPO = {
                code: poSelect.value,
                quantity: quantity,
                supplier: supplier,
                date: date
            };
            
            detailsDiv.style.display = 'block';
            updateRestoreSummary();
        }

        function setMaxRestore() {
            const maxQty = window.currentPO ? window.currentPO.quantity : 0;
            document.getElementById('restoreQuantity').value = maxQty;
            updateRestoreSummary();
        }

        function updateRestoreSummary() {
            const currentStock = window.currentRestoreStock ? window.currentRestoreStock.balance : 0;
            const receiving = parseInt(document.getElementById('restoreQuantity').value) || 0;
            const finalBalance = currentStock + receiving;
            const confirmBtn = document.getElementById('confirmRestoreBtn');
            
            document.getElementById('summaryCurrentBalance').textContent = currentStock + ' un.';
            document.getElementById('summaryReceiving').textContent = receiving + ' un.';
            document.getElementById('summaryFinalBalance').textContent = finalBalance + ' un.';
            
            // Habilitar bot√£o confirmar se quantidade > 0
            confirmBtn.disabled = receiving <= 0;
        }

        function confirmRestore() {
            const po = window.currentPO;
            const stock = window.currentRestoreStock;
            const receiving = parseInt(document.getElementById('restoreQuantity').value) || 0;
            
            if (!po || !stock || receiving <= 0) {
                alert('‚ö†Ô∏è Dados inv√°lidos para restaura√ß√£o');
                return;
            }
            
            showLoadingBar();
            
            setTimeout(() => {
                const finalBalance = stock.balance + receiving;
                alert(`‚úÖ Estoque restaurado com sucesso!\n\nüì¶ Ordem: ${po.code}\nüè∑Ô∏è Produto: ${stock.sku}\nüìç Posi√ß√£o: ${stock.position}\nüì• Recebido: ${receiving} un.\nüìä Saldo Final: ${finalBalance} un.\n\nüöö Fornecedor: ${po.supplier}`);
                closeModal('restoreStockModal');
            }, 1500);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }

        // Reports Functions
        const reportsData = {
            'exits-by-posto': {
                title: 'üè™ Sa√≠das por Posto',
                data: [
                    { posto: 'E-01', suposto: 'E-01-1', type: 'ESTOQUE', exits: 342, products: 28, avgTime: '2.1min' },
                    { posto: 'P-01', suposto: 'P-01-1', type: 'PULM√ÉO', exits: 589, products: 45, avgTime: '1.8min' },
                    { posto: 'P-01', suposto: 'P-01-2', type: 'PULM√ÉO', exits: 512, products: 38, avgTime: '2.0min' },
                    { posto: 'PK-01', suposto: 'PK-01-1', type: 'PICKING', exits: 1247, products: 67, avgTime: '0.9min' },
                    { posto: 'PK-01', suposto: 'PK-01-2', type: 'PICKING', exits: 1089, products: 54, avgTime: '1.2min' },
                    { posto: 'E-02', suposto: 'E-02-1', type: 'ESTOQUE', exits: 178, products: 19, avgTime: '2.5min' },
                    { posto: 'P-02', suposto: 'P-02-1', type: 'PULM√ÉO', exits: 423, products: 31, avgTime: '1.9min' }
                ]
            },
            'product-exits': {
                title: 'üì¶ Sa√≠das de Produtos',
                data: [
                    { rank: 1, sku: 'SKU001', product: 'Mouse Gamer RGB', exits: 487, revenue: 'R$ 14.610,00', growth: '+12.5%' },
                    { rank: 2, sku: 'SKU002', product: 'Teclado Mec√¢nico', exits: 423, revenue: 'R$ 31.725,00', growth: '+8.3%' },
                    { rank: 3, sku: 'SKU003', product: 'Monitor 24" Full HD', exits: 312, revenue: 'R$ 187.200,00', growth: '+15.7%' },
                    { rank: 4, sku: 'SKU005', product: 'Webcam HD', exits: 289, revenue: 'R$ 8.670,00', growth: '+5.2%' },
                    { rank: 5, sku: 'SKU004', product: 'Fone Bluetooth', exits: 267, revenue: 'R$ 16.020,00', growth: '-2.1%' },
                    { rank: 6, sku: 'SKU008', product: 'Hub USB', exits: 245, revenue: 'R$ 4.900,00', growth: '+3.8%' },
                    { rank: 7, sku: 'SKU006', product: 'Mousepad XL', exits: 198, revenue: 'R$ 2.970,00', growth: '+7.4%' },
                    { rank: 8, sku: 'SKU007', product: 'Suporte Monitor', exits: 156, revenue: 'R$ 9.360,00', growth: '+1.9%' }
                ]
            },
            'operator-productivity': {
                title: 'üë• Produtividade de Operadores',
                data: [
                    { rank: 1, operator: 'Jo√£o Silva', orders: 487, items: 1543, accuracy: '99.2%', avgTime: '3.8min', performance: 'Excelente' },
                    { rank: 2, operator: 'Maria Santos', orders: 451, items: 1421, accuracy: '98.9%', avgTime: '4.1min', performance: 'Excelente' },
                    { rank: 3, operator: 'Pedro Costa', orders: 423, items: 1334, accuracy: '98.5%', avgTime: '4.3min', performance: 'Bom' },
                    { rank: 4, operator: 'Ana Oliveira', orders: 398, items: 1287, accuracy: '99.0%', avgTime: '4.5min', performance: 'Bom' },
                    { rank: 5, operator: 'Carlos Mendes', orders: 367, items: 1156, accuracy: '97.8%', avgTime: '4.8min', performance: 'Bom' },
                    { rank: 6, operator: 'Julia Lima', orders: 342, items: 1089, accuracy: '98.3%', avgTime: '5.1min', performance: 'Regular' },
                    { rank: 7, operator: 'Ricardo Souza', orders: 298, items: 934, accuracy: '97.5%', avgTime: '5.4min', performance: 'Regular' }
                ]
            },
            'platform-analysis': {
                title: 'üîó An√°lise por Plataforma',
                data: [
                    { platform: 'Mercado Livre', orders: 523, items: 1687, revenue: 'R$ 127.450,00', share: '42%', growth: '+15.2%' },
                    { platform: 'Shopee', orders: 412, items: 1324, revenue: 'R$ 89.320,00', share: '32%', growth: '+22.7%' },
                    { platform: 'Amazon', orders: 234, items: 756, revenue: 'R$ 58.970,00', share: '18%', growth: '+8.4%' },
                    { platform: 'Magalu', orders: 78, items: 124, revenue: 'R$ 18.260,00', share: '8%', growth: '+5.1%' }
                ]
            },
            'occupation-rate': {
                title: 'üìä Taxa de Ocupa√ß√£o de Posi√ß√µes',
                data: [
                    { position: 'E-01-1', type: 'ESTOQUE', capacity: 1000, used: 847, rate: '84.7%', status: 'Alto' },
                    { position: 'E-01-2', type: 'ESTOQUE', capacity: 1000, used: 623, rate: '62.3%', status: 'M√©dio' },
                    { position: 'E-02-1', type: 'ESTOQUE', capacity: 500, used: 312, rate: '62.4%', status: 'M√©dio' },
                    { position: 'P-01-1', type: 'PULM√ÉO', capacity: 300, used: 267, rate: '89.0%', status: 'Alto' },
                    { position: 'P-01-2', type: 'PULM√ÉO', capacity: 300, used: 198, rate: '66.0%', status: 'M√©dio' },
                    { position: 'P-02-1', type: 'PULM√ÉO', capacity: 300, used: 145, rate: '48.3%', status: 'Baixo' },
                    { position: 'PK-01-1', type: 'PICKING', capacity: 150, used: 127, rate: '84.7%', status: 'Alto' },
                    { position: 'PK-01-2', type: 'PICKING', capacity: 150, used: 89, rate: '59.3%', status: 'M√©dio' }
                ]
            },
            'picking-time': {
                title: '‚è±Ô∏è Tempo M√©dio de Separa√ß√£o',
                data: [
                    { date: '15/01', orders: 178, avgTime: '4.8min', totalTime: '14.2h', efficiency: '87%' },
                    { date: '16/01', orders: 192, avgTime: '4.5min', totalTime: '14.4h', efficiency: '89%' },
                    { date: '17/01', orders: 203, avgTime: '4.3min', totalTime: '14.6h', efficiency: '91%' },
                    { date: '18/01', orders: 189, avgTime: '4.4min', totalTime: '13.9h', efficiency: '90%' },
                    { date: '19/01', orders: 215, avgTime: '4.1min', totalTime: '14.7h', efficiency: '93%' },
                    { date: '20/01', orders: 198, avgTime: '4.2min', totalTime: '13.9h', efficiency: '92%' },
                    { date: '21/01', orders: 72, avgTime: '4.6min', totalTime: '5.5h', efficiency: '88%' }
                ]
            }
        };

        function openReportModal(reportType) {
            const report = reportsData[reportType];
            if (!report) return;

            document.getElementById('reportModalTitle').textContent = report.title;
            const content = document.getElementById('reportContent');
            
            let html = '';

            // Render different layouts based on report type
            if (reportType === 'exits-by-posto') {
                html = `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Total de Sa√≠das</div>
                                <div class="stat-value" style="color: white;">3.891</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Postos Ativos</div>
                                <div class="stat-value" style="color: white;">7</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Tempo M√©dio</div>
                                <div class="stat-value" style="color: white;">1.8min</div>
                            </div>
                        </div>
                    </div>
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Posto</th>
                                <th>Suposto</th>
                                <th>Tipo</th>
                                <th>Sa√≠das</th>
                                <th>Produtos</th>
                                <th>Tempo M√©dio</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${report.data.map(item => `
                                <tr>
                                    <td><strong>${item.posto}</strong></td>
                                    <td>${item.suposto}</td>
                                    <td>
                                        <span class="badge ${item.type === 'ESTOQUE' ? 'badge-info' : item.type === 'PULM√ÉO' ? 'badge-warning' : 'badge-success'}">
                                            ${item.type === 'ESTOQUE' ? 'üè™' : item.type === 'PULM√ÉO' ? 'üì¶' : 'üéØ'} ${item.type}
                                        </span>
                                    </td>
                                    <td><strong>${item.exits}</strong></td>
                                    <td>${item.products}</td>
                                    <td>${item.avgTime}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } else if (reportType === 'product-exits') {
                html = `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Total Vendido</div>
                                <div class="stat-value" style="color: white;">R$ 275K</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">SKUs Ativos</div>
                                <div class="stat-value" style="color: white;">8</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Crescimento M√©dio</div>
                                <div class="stat-value" style="color: white;">+7.2%</div>
                            </div>
                        </div>
                    </div>
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th style="width: 60px;">Rank</th>
                                <th>SKU</th>
                                <th>Produto</th>
                                <th>Sa√≠das</th>
                                <th>Faturamento</th>
                                <th>Crescimento</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${report.data.map(item => `
                                <tr>
                                    <td style="text-align: center;">
                                        <span style="display: inline-flex; align-items: center; justify-content: center; width: 32px; height: 32px; border-radius: 50%; background: ${item.rank <= 3 ? 'linear-gradient(135deg, #ffd700 0%, #ffed4e 100%)' : 'var(--gray-200)'}; font-weight: 700; color: ${item.rank <= 3 ? '#6b4600' : 'var(--gray-600)'};">
                                            ${item.rank}
                                        </span>
                                    </td>
                                    <td><code>${item.sku}</code></td>
                                    <td><strong>${item.product}</strong></td>
                                    <td><strong>${item.exits}</strong></td>
                                    <td>${item.revenue}</td>
                                    <td>
                                        <span class="${item.growth.startsWith('+') ? 'stat-change positive' : 'stat-change negative'}" style="font-size: 0.875rem;">
                                            <span>${item.growth.startsWith('+') ? '‚Üë' : '‚Üì'}</span> ${item.growth}
                                        </span>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } else if (reportType === 'operator-productivity') {
                html = `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Operadores</div>
                                <div class="stat-value" style="color: white;">7</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Acur√°cia M√©dia</div>
                                <div class="stat-value" style="color: white;">98.5%</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Produtividade</div>
                                <div class="stat-value" style="color: white;">4.6min</div>
                            </div>
                        </div>
                    </div>
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th style="width: 60px;">Rank</th>
                                <th>Operador</th>
                                <th>Pedidos</th>
                                <th>Itens</th>
                                <th>Acur√°cia</th>
                                <th>Tempo M√©dio</th>
                                <th>Performance</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${report.data.map(item => `
                                <tr>
                                    <td style="text-align: center;">
                                        <span style="display: inline-flex; align-items: center; justify-content: center; width: 32px; height: 32px; border-radius: 50%; background: ${item.rank <= 3 ? 'linear-gradient(135deg, #ffd700 0%, #ffed4e 100%)' : 'var(--gray-200)'}; font-weight: 700; color: ${item.rank <= 3 ? '#6b4600' : 'var(--gray-600)'};">
                                            ${item.rank}
                                        </span>
                                    </td>
                                    <td><strong>${item.operator}</strong></td>
                                    <td>${item.orders}</td>
                                    <td>${item.items}</td>
                                    <td><strong>${item.accuracy}</strong></td>
                                    <td>${item.avgTime}</td>
                                    <td>
                                        <span class="badge ${item.performance === 'Excelente' ? 'badge-success' : item.performance === 'Bom' ? 'badge-info' : 'badge-warning'}">
                                            ${item.performance === 'Excelente' ? '‚≠ê' : item.performance === 'Bom' ? '‚úÖ' : 'üìä'} ${item.performance}
                                        </span>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } else if (reportType === 'platform-analysis') {
                html = `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Total Vendido</div>
                                <div class="stat-value" style="color: white;">R$ 294K</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Plataformas</div>
                                <div class="stat-value" style="color: white;">4</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Crescimento</div>
                                <div class="stat-value" style="color: white;">+15.2%</div>
                            </div>
                        </div>
                    </div>
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Plataforma</th>
                                <th>Pedidos</th>
                                <th>Itens</th>
                                <th>Faturamento</th>
                                <th>Participa√ß√£o</th>
                                <th>Crescimento</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${report.data.map(item => `
                                <tr>
                                    <td><strong>${item.platform}</strong></td>
                                    <td>${item.orders}</td>
                                    <td>${item.items}</td>
                                    <td><strong>${item.revenue}</strong></td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <div style="flex: 1; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden;">
                                                <div style="height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); width: ${item.share}; transition: width 0.3s;"></div>
                                            </div>
                                            <span style="font-weight: 600; min-width: 40px;">${item.share}</span>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="stat-change positive" style="font-size: 0.875rem;">
                                            <span>‚Üë</span> ${item.growth}
                                        </span>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } else if (reportType === 'occupation-rate') {
                html = `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Ocupa√ß√£o M√©dia</div>
                                <div class="stat-value" style="color: white;">69.8%</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Capacidade Total</div>
                                <div class="stat-value" style="color: white;">3.700</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Em Uso</div>
                                <div class="stat-value" style="color: white;">2.608</div>
                            </div>
                        </div>
                    </div>
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Posi√ß√£o</th>
                                <th>Tipo</th>
                                <th>Capacidade</th>
                                <th>Utilizado</th>
                                <th>Taxa</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${report.data.map(item => `
                                <tr>
                                    <td><strong>${item.position}</strong></td>
                                    <td>
                                        <span class="badge ${item.type === 'ESTOQUE' ? 'badge-info' : item.type === 'PULM√ÉO' ? 'badge-warning' : 'badge-success'}">
                                            ${item.type === 'ESTOQUE' ? 'üè™' : item.type === 'PULM√ÉO' ? 'üì¶' : 'üéØ'} ${item.type}
                                        </span>
                                    </td>
                                    <td>${item.capacity}</td>
                                    <td>${item.used}</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <div style="flex: 1; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden;">
                                                <div style="height: 100%; background: ${parseFloat(item.rate) >= 80 ? 'linear-gradient(90deg, #f093fb 0%, #f5576c 100%)' : parseFloat(item.rate) >= 60 ? 'linear-gradient(90deg, #fa709a 0%, #fee140 100%)' : 'linear-gradient(90deg, #43e97b 0%, #38f9d7 100%)'}; width: ${item.rate}; transition: width 0.3s;"></div>
                                            </div>
                                            <span style="font-weight: 600; min-width: 50px;">${item.rate}</span>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge ${item.status === 'Alto' ? 'badge-danger' : item.status === 'M√©dio' ? 'badge-warning' : 'badge-success'}">
                                            ${item.status}
                                        </span>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } else if (reportType === 'picking-time') {
                html = `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #374151;">
                                <div class="stat-title">Tempo M√©dio Geral</div>
                                <div class="stat-value">4.4min</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Total de Pedidos</div>
                                <div class="stat-value" style="color: white;">1.247</div>
                            </div>
                            <div class="stat-card" style="flex: 1; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white;">
                                <div class="stat-title" style="color: rgba(255,255,255,0.9);">Efici√™ncia M√©dia</div>
                                <div class="stat-value" style="color: white;">90%</div>
                            </div>
                        </div>
                    </div>
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Pedidos</th>
                                <th>Tempo M√©dio</th>
                                <th>Tempo Total</th>
                                <th>Efici√™ncia</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${report.data.map(item => `
                                <tr>
                                    <td><strong>${item.date}</strong></td>
                                    <td>${item.orders}</td>
                                    <td><strong>${item.avgTime}</strong></td>
                                    <td>${item.totalTime}</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <div style="flex: 1; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden;">
                                                <div style="height: 100%; background: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%); width: ${item.efficiency}; transition: width 0.3s;"></div>
                                            </div>
                                            <span style="font-weight: 600; min-width: 40px;">${item.efficiency}</span>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }

            content.innerHTML = html;
            openModal('reportModal');
        }

        function exportReport() {
            alert('Funcionalidade de exporta√ß√£o ser√° implementada em breve!\n\nO relat√≥rio atual ser√° exportado em formato CSV.');
        }
    </script>
</body>
</html>
